"use strict";var Jn=Object.defineProperty;var Qn=(t,e,n)=>e in t?Jn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var N=(t,e,n)=>(Qn(t,typeof e!="symbol"?e+"":e,n),n);const re=require("siyuan");var Yn=Object.defineProperty,Xn=(t,e,n)=>e in t?Yn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,G=(t,e,n)=>(Xn(t,typeof e!="symbol"?e+"":e,n),n);const Zn=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,eo=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,to=/^\s*["[{]|^\s*-?\d[\d.]{0,14}\s*$/;function no(t,e){if(t==="__proto__"||t==="constructor"&&e&&typeof e=="object"&&"prototype"in e){oo(t);return}return e}function oo(t){console.warn(`[destr] Dropping "${t}" key to prevent prototype pollution.`)}function ro(t,e={}){if(typeof t!="string")return t;const n=t.trim();if(t[0]==='"'&&t[t.length-1]==='"')return n.slice(1,-1);if(n.length<=9){const o=n.toLowerCase();if(o==="true")return!0;if(o==="false")return!1;if(o==="undefined")return;if(o==="null")return null;if(o==="nan")return Number.NaN;if(o==="infinity")return Number.POSITIVE_INFINITY;if(o==="-infinity")return Number.NEGATIVE_INFINITY}if(!to.test(t)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return t}try{if(Zn.test(t)||eo.test(t)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(t,no)}return JSON.parse(t)}catch(o){if(e.strict)throw o;return t}}const so=/#/g,io=/&/g,ao=/=/g,mt=/\+/g,lo=/%5e/gi,co=/%60/gi,uo=/%7c/gi,fo=/%20/gi;function ho(t){return encodeURI(""+t).replace(uo,"|")}function nt(t){return ho(typeof t=="string"?t:JSON.stringify(t)).replace(mt,"%2B").replace(fo,"+").replace(so,"%23").replace(io,"%26").replace(co,"`").replace(lo,"^")}function Ke(t){return nt(t).replace(ao,"%3D")}function hn(t=""){try{return decodeURIComponent(""+t)}catch{return""+t}}function po(t){return hn(t.replace(mt," "))}function mo(t){return hn(t.replace(mt," "))}function go(t=""){const e={};t[0]==="?"&&(t=t.slice(1));for(const n of t.split("&")){const o=n.match(/([^=]+)=?(.*)/)||[];if(o.length<2)continue;const r=po(o[1]);if(r==="__proto__"||r==="constructor")continue;const s=mo(o[2]||"");e[r]===void 0?e[r]=s:Array.isArray(e[r])?e[r].push(s):e[r]=[e[r],s]}return e}function bo(t,e){return(typeof e=="number"||typeof e=="boolean")&&(e=String(e)),e?Array.isArray(e)?e.map(n=>`${Ke(t)}=${nt(n)}`).join("&"):`${Ke(t)}=${nt(e)}`:Ke(t)}function yo(t){return Object.keys(t).filter(e=>t[e]!==void 0).map(e=>bo(e,t[e])).filter(Boolean).join("&")}const _o=/^[\s\w\0+.-]{2,}:([/\\]{1,2})/,wo=/^[\s\w\0+.-]{2,}:([/\\]{2})?/,ko=/^([/\\]\s*){2,}[^/\\]/;function pn(t,e={}){return typeof e=="boolean"&&(e={acceptRelative:e}),e.strict?_o.test(t):wo.test(t)||(e.acceptRelative?ko.test(t):!1)}const Eo=/\/$|\/\?/;function ot(t="",e=!1){return e?Eo.test(t):t.endsWith("/")}function So(t="",e=!1){if(!e)return(ot(t)?t.slice(0,-1):t)||"/";if(!ot(t,!0))return t||"/";const[n,...o]=t.split("?");return(n.slice(0,-1)||"/")+(o.length>0?`?${o.join("?")}`:"")}function To(t="",e=!1){if(!e)return t.endsWith("/")?t:t+"/";if(ot(t,!0))return t||"/";const[n,...o]=t.split("?");return n+"/"+(o.length>0?`?${o.join("?")}`:"")}function vo(t,e){if(Ao(e)||pn(t))return t;const n=So(e);return t.startsWith(n)?t:Po(n,t)}function Oo(t,e){const n=dn(t),o={...go(n.search),...e};return n.search=yo(o),Bo(n)}function Ao(t){return!t||t==="/"}function No(t){return t&&t!=="/"}const Co=/^\.?\//;function Po(t,...e){let n=t||"";for(const o of e.filter(r=>No(r)))if(n){const r=o.replace(Co,"");n=To(n)+r}else n=o;return n}function dn(t="",e){const n=t.match(/^[\s\0]*(blob:|data:|javascript:|vbscript:)(.*)/);if(n){const[,p,b=""]=n;return{protocol:p,pathname:b,href:p+b,auth:"",host:"",search:"",hash:""}}if(!pn(t,{acceptRelative:!0}))return e?dn(e+t):St(t);const[,o="",r,s=""]=t.replace(/\\/g,"/").match(/^[\s\0]*([\w+.-]{2,}:)?\/\/([^/@]+@)?(.*)/)||[],[,i="",a=""]=s.match(/([^#/?]*)(.*)?/)||[],{pathname:u,search:c,hash:l}=St(a.replace(/\/(?=[A-Za-z]:)/,""));return{protocol:o,auth:r?r.slice(0,Math.max(0,r.length-1)):"",host:i,pathname:u,search:c,hash:l}}function St(t=""){const[e="",n="",o=""]=(t.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:e,search:n,hash:o}}function Bo(t){const e=t.pathname||"",n=t.search?(t.search.startsWith("?")?"":"?")+t.search:"",o=t.hash||"",r=t.auth?t.auth+"@":"",s=t.host||"";return(t.protocol?t.protocol+"//":"")+r+s+e+n+o}class Ro extends Error{constructor(e,n){super(e,n),this.name="FetchError",n!=null&&n.cause&&!this.cause&&(this.cause=n.cause)}}function Lo(t){var e,n,o,r,s;const i=((e=t.error)==null?void 0:e.message)||((n=t.error)==null?void 0:n.toString())||"",a=((o=t.request)==null?void 0:o.method)||((r=t.options)==null?void 0:r.method)||"GET",u=((s=t.request)==null?void 0:s.url)||String(t.request)||"/",c=`[${a}] ${JSON.stringify(u)}`,l=t.response?`${t.response.status} ${t.response.statusText}`:"<no response>",p=`${c}: ${l}${i?` ${i}`:""}`,b=new Ro(p,t.error?{cause:t.error}:void 0);for(const h of["request","options","response"])Object.defineProperty(b,h,{get(){return t[h]}});for(const[h,y]of[["data","_data"],["status","status"],["statusCode","status"],["statusText","statusText"],["statusMessage","statusText"]])Object.defineProperty(b,h,{get(){return t.response&&t.response[y]}});return b}const Do=new Set(Object.freeze(["PATCH","POST","PUT","DELETE"]));function Tt(t="GET"){return Do.has(t.toUpperCase())}function jo(t){if(t===void 0)return!1;const e=typeof t;return e==="string"||e==="number"||e==="boolean"||e===null?!0:e!=="object"?!1:Array.isArray(t)?!0:t.buffer?!1:t.constructor&&t.constructor.name==="Object"||typeof t.toJSON=="function"}const Fo=new Set(["image/svg","application/xml","application/xhtml","application/html"]),qo=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function Mo(t=""){if(!t)return"json";const e=t.split(";").shift()||"";return qo.test(e)?"json":Fo.has(e)||e.startsWith("text/")?"text":"blob"}function Uo(t,e,n=globalThis.Headers){const o={...e,...t};if(e!=null&&e.params&&t!=null&&t.params&&(o.params={...e==null?void 0:e.params,...t==null?void 0:t.params}),e!=null&&e.query&&t!=null&&t.query&&(o.query={...e==null?void 0:e.query,...t==null?void 0:t.query}),e!=null&&e.headers&&t!=null&&t.headers){o.headers=new n((e==null?void 0:e.headers)||{});for(const[r,s]of new n((t==null?void 0:t.headers)||{}))o.headers.set(r,s)}return o}const Io=new Set([408,409,425,429,500,502,503,504]),$o=new Set([101,204,205,304]);function mn(t={}){const{fetch:e=globalThis.fetch,Headers:n=globalThis.Headers,AbortController:o=globalThis.AbortController}=t;async function r(a){const u=a.error&&a.error.name==="AbortError"&&!a.options.timeout||!1;if(a.options.retry!==!1&&!u){let l;typeof a.options.retry=="number"?l=a.options.retry:l=Tt(a.options.method)?0:1;const p=a.response&&a.response.status||500;if(l>0&&(Array.isArray(a.options.retryStatusCodes)?a.options.retryStatusCodes.includes(p):Io.has(p))){const b=a.options.retryDelay||0;return b>0&&await new Promise(h=>setTimeout(h,b)),s(a.request,{...a.options,retry:l-1,timeout:a.options.timeout})}}const c=Lo(a);throw Error.captureStackTrace&&Error.captureStackTrace(c,s),c}const s=async function(a,u={}){var c;const l={request:a,options:Uo(u,t.defaults,n),response:void 0,error:void 0};if(l.options.method=(c=l.options.method)==null?void 0:c.toUpperCase(),l.options.onRequest&&await l.options.onRequest(l),typeof l.request=="string"&&(l.options.baseURL&&(l.request=vo(l.request,l.options.baseURL)),(l.options.query||l.options.params)&&(l.request=Oo(l.request,{...l.options.params,...l.options.query}))),l.options.body&&Tt(l.options.method)&&(jo(l.options.body)?(l.options.body=typeof l.options.body=="string"?l.options.body:JSON.stringify(l.options.body),l.options.headers=new n(l.options.headers||{}),l.options.headers.has("content-type")||l.options.headers.set("content-type","application/json"),l.options.headers.has("accept")||l.options.headers.set("accept","application/json")):("pipeTo"in l.options.body&&typeof l.options.body.pipeTo=="function"||typeof l.options.body.pipe=="function")&&("duplex"in l.options||(l.options.duplex="half"))),!l.options.signal&&l.options.timeout){const p=new o;setTimeout(()=>p.abort(),l.options.timeout),l.options.signal=p.signal}try{l.response=await e(l.request,l.options)}catch(p){return l.error=p,l.options.onRequestError&&await l.options.onRequestError(l),await r(l)}if(l.response.body&&!$o.has(l.response.status)&&l.options.method!=="HEAD"){const p=(l.options.parseResponse?"json":l.options.responseType)||Mo(l.response.headers.get("content-type")||"");switch(p){case"json":{const b=await l.response.text(),h=l.options.parseResponse||ro;l.response._data=h(b);break}case"stream":{l.response._data=l.response.body;break}default:l.response._data=await l.response[p]()}}return l.options.onResponse&&await l.options.onResponse(l),!l.options.ignoreResponseError&&l.response.status>=400&&l.response.status<600?(l.options.onResponseError&&await l.options.onResponseError(l),await r(l)):l.response},i=async function(a,u){return(await s(a,u))._data};return i.raw=s,i.native=(...a)=>e(...a),i.create=(a={})=>mn({...t,defaults:{...t.defaults,...a}}),i}const gt=function(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}(),Ho=gt.fetch||(()=>Promise.reject(new Error("[ofetch] global.fetch is not supported!"))),zo=gt.Headers,Vo=gt.AbortController,Wo=mn({fetch:Ho,Headers:zo,AbortController:Vo});class xo extends Error{constructor(e){super(e.statusText),G(this,"status"),this.response=e,this.status=e.status}}class vt extends Error{constructor(e,n){super(e.msg),G(this,"code"),this.body=e,this.response=n,this.code=e.code}}function z(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}function Ot(t,e){for(var n="",o=0,r=-1,s=0,i,a=0;a<=t.length;++a){if(a<t.length)i=t.charCodeAt(a);else{if(i===47)break;i=47}if(i===47){if(!(r===a-1||s===1))if(r!==a-1&&s===2){if(n.length<2||o!==2||n.charCodeAt(n.length-1)!==46||n.charCodeAt(n.length-2)!==46){if(n.length>2){var u=n.lastIndexOf("/");if(u!==n.length-1){u===-1?(n="",o=0):(n=n.slice(0,u),o=n.length-1-n.lastIndexOf("/")),r=a,s=0;continue}}else if(n.length===2||n.length===1){n="",o=0,r=a,s=0;continue}}e&&(n.length>0?n+="/..":n="..",o=2)}else n.length>0?n+="/"+t.slice(r+1,a):n=t.slice(r+1,a),o=a-r-1;r=a,s=0}else i===46&&s!==-1?++s:s=-1}return n}function Ko(t,e){var n=e.dir||e.root,o=e.base||(e.name||"")+(e.ext||"");return n?n===e.root?n+o:n+t+o:o}var ye={resolve:function(){for(var t="",e=!1,n,o=arguments.length-1;o>=-1&&!e;o--){var r;o>=0?r=arguments[o]:(n===void 0&&(n=process.cwd()),r=n),z(r),r.length!==0&&(t=r+"/"+t,e=r.charCodeAt(0)===47)}return t=Ot(t,!e),e?t.length>0?"/"+t:"/":t.length>0?t:"."},normalize:function(t){if(z(t),t.length===0)return".";var e=t.charCodeAt(0)===47,n=t.charCodeAt(t.length-1)===47;return t=Ot(t,!e),t.length===0&&!e&&(t="."),t.length>0&&n&&(t+="/"),e?"/"+t:t},isAbsolute:function(t){return z(t),t.length>0&&t.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var t,e=0;e<arguments.length;++e){var n=arguments[e];z(n),n.length>0&&(t===void 0?t=n:t+="/"+n)}return t===void 0?".":ye.normalize(t)},relative:function(t,e){if(z(t),z(e),t===e||(t=ye.resolve(t),e=ye.resolve(e),t===e))return"";for(var n=1;n<t.length&&t.charCodeAt(n)===47;++n);for(var o=t.length,r=o-n,s=1;s<e.length&&e.charCodeAt(s)===47;++s);for(var i=e.length,a=i-s,u=r<a?r:a,c=-1,l=0;l<=u;++l){if(l===u){if(a>u){if(e.charCodeAt(s+l)===47)return e.slice(s+l+1);if(l===0)return e.slice(s+l)}else r>u&&(t.charCodeAt(n+l)===47?c=l:l===0&&(c=0));break}var p=t.charCodeAt(n+l),b=e.charCodeAt(s+l);if(p!==b)break;p===47&&(c=l)}var h="";for(l=n+c+1;l<=o;++l)(l===o||t.charCodeAt(l)===47)&&(h.length===0?h+="..":h+="/..");return h.length>0?h+e.slice(s+c):(s+=c,e.charCodeAt(s)===47&&++s,e.slice(s))},_makeLong:function(t){return t},dirname:function(t){if(z(t),t.length===0)return".";for(var e=t.charCodeAt(0),n=e===47,o=-1,r=!0,s=t.length-1;s>=1;--s)if(e=t.charCodeAt(s),e===47){if(!r){o=s;break}}else r=!1;return o===-1?n?"/":".":n&&o===1?"//":t.slice(0,o)},basename:function(t,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');z(t);var n=0,o=-1,r=!0,s;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";var i=e.length-1,a=-1;for(s=t.length-1;s>=0;--s){var u=t.charCodeAt(s);if(u===47){if(!r){n=s+1;break}}else a===-1&&(r=!1,a=s+1),i>=0&&(u===e.charCodeAt(i)?--i===-1&&(o=s):(i=-1,o=a))}return n===o?o=a:o===-1&&(o=t.length),t.slice(n,o)}else{for(s=t.length-1;s>=0;--s)if(t.charCodeAt(s)===47){if(!r){n=s+1;break}}else o===-1&&(r=!1,o=s+1);return o===-1?"":t.slice(n,o)}},extname:function(t){z(t);for(var e=-1,n=0,o=-1,r=!0,s=0,i=t.length-1;i>=0;--i){var a=t.charCodeAt(i);if(a===47){if(!r){n=i+1;break}continue}o===-1&&(r=!1,o=i+1),a===46?e===-1?e=i:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||o===-1||s===0||s===1&&e===o-1&&e===n+1?"":t.slice(e,o)},format:function(t){if(t===null||typeof t!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof t);return Ko("/",t)},parse:function(t){z(t);var e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;var n=t.charCodeAt(0),o=n===47,r;o?(e.root="/",r=1):r=0;for(var s=-1,i=0,a=-1,u=!0,c=t.length-1,l=0;c>=r;--c){if(n=t.charCodeAt(c),n===47){if(!u){i=c+1;break}continue}a===-1&&(u=!1,a=c+1),n===46?s===-1?s=c:l!==1&&(l=1):s!==-1&&(l=-1)}return s===-1||a===-1||l===0||l===1&&s===a-1&&s===i+1?a!==-1&&(i===0&&o?e.base=e.name=t.slice(1,a):e.base=e.name=t.slice(i,a)):(i===0&&o?(e.name=t.slice(1,s),e.base=t.slice(1,a)):(e.name=t.slice(i,s),e.base=t.slice(i,a)),e.ext=t.slice(s,a)),i>0?e.dir=t.slice(0,i-1):o&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};ye.posix=ye;function gn(t,e){return function(){return t.apply(e,arguments)}}const{toString:Go}=Object.prototype,{getPrototypeOf:bt}=Object,He=(t=>e=>{const n=Go.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),x=t=>(t=t.toLowerCase(),e=>He(e)===t),ze=t=>e=>typeof e===t,{isArray:he}=Array,ke=ze("undefined");function Jo(t){return t!==null&&!ke(t)&&t.constructor!==null&&!ke(t.constructor)&&U(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const bn=x("ArrayBuffer");function Qo(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&bn(t.buffer),e}const Yo=ze("string"),U=ze("function"),yn=ze("number"),Ve=t=>t!==null&&typeof t=="object",Xo=t=>t===!0||t===!1,Le=t=>{if(He(t)!=="object")return!1;const e=bt(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Zo=x("Date"),er=x("File"),tr=x("Blob"),nr=x("FileList"),or=t=>Ve(t)&&U(t.pipe),rr=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||U(t.append)&&((e=He(t))==="formdata"||e==="object"&&U(t.toString)&&t.toString()==="[object FormData]"))},sr=x("URLSearchParams"),ir=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Te(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let o,r;if(typeof t!="object"&&(t=[t]),he(t))for(o=0,r=t.length;o<r;o++)e.call(null,t[o],o,t);else{const s=n?Object.getOwnPropertyNames(t):Object.keys(t),i=s.length;let a;for(o=0;o<i;o++)a=s[o],e.call(null,t[a],a,t)}}function _n(t,e){e=e.toLowerCase();const n=Object.keys(t);let o=n.length,r;for(;o-- >0;)if(r=n[o],e===r.toLowerCase())return r;return null}const wn=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),kn=t=>!ke(t)&&t!==wn;function rt(){const{caseless:t}=kn(this)&&this||{},e={},n=(o,r)=>{const s=t&&_n(e,r)||r;Le(e[s])&&Le(o)?e[s]=rt(e[s],o):Le(o)?e[s]=rt({},o):he(o)?e[s]=o.slice():e[s]=o};for(let o=0,r=arguments.length;o<r;o++)arguments[o]&&Te(arguments[o],n);return e}const ar=(t,e,n,{allOwnKeys:o}={})=>(Te(e,(r,s)=>{n&&U(r)?t[s]=gn(r,n):t[s]=r},{allOwnKeys:o}),t),lr=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),cr=(t,e,n,o)=>{t.prototype=Object.create(e.prototype,o),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},ur=(t,e,n,o)=>{let r,s,i;const a={};if(e=e||{},t==null)return e;do{for(r=Object.getOwnPropertyNames(t),s=r.length;s-- >0;)i=r[s],(!o||o(i,t,e))&&!a[i]&&(e[i]=t[i],a[i]=!0);t=n!==!1&&bt(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},fr=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const o=t.indexOf(e,n);return o!==-1&&o===n},hr=t=>{if(!t)return null;if(he(t))return t;let e=t.length;if(!yn(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},pr=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&bt(Uint8Array)),dr=(t,e)=>{const n=(t&&t[Symbol.iterator]).call(t);let o;for(;(o=n.next())&&!o.done;){const r=o.value;e.call(t,r[0],r[1])}},mr=(t,e)=>{let n;const o=[];for(;(n=t.exec(e))!==null;)o.push(n);return o},gr=x("HTMLFormElement"),br=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,n,o){return n.toUpperCase()+o}),At=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),yr=x("RegExp"),En=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),o={};Te(n,(r,s)=>{let i;(i=e(r,s,t))!==!1&&(o[s]=i||r)}),Object.defineProperties(t,o)},_r=t=>{En(t,(e,n)=>{if(U(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const o=t[n];if(U(o)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},wr=(t,e)=>{const n={},o=r=>{r.forEach(s=>{n[s]=!0})};return he(t)?o(t):o(String(t).split(e)),n},kr=()=>{},Er=(t,e)=>(t=+t,Number.isFinite(t)?t:e),Ge="abcdefghijklmnopqrstuvwxyz",Nt="0123456789",Sn={DIGIT:Nt,ALPHA:Ge,ALPHA_DIGIT:Ge+Ge.toUpperCase()+Nt},Sr=(t=16,e=Sn.ALPHA_DIGIT)=>{let n="";const{length:o}=e;for(;t--;)n+=e[Math.random()*o|0];return n};function Tr(t){return!!(t&&U(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const vr=t=>{const e=new Array(10),n=(o,r)=>{if(Ve(o)){if(e.indexOf(o)>=0)return;if(!("toJSON"in o)){e[r]=o;const s=he(o)?[]:{};return Te(o,(i,a)=>{const u=n(i,r+1);!ke(u)&&(s[a]=u)}),e[r]=void 0,s}}return o};return n(t,0)},Or=x("AsyncFunction"),Ar=t=>t&&(Ve(t)||U(t))&&U(t.then)&&U(t.catch),d={isArray:he,isArrayBuffer:bn,isBuffer:Jo,isFormData:rr,isArrayBufferView:Qo,isString:Yo,isNumber:yn,isBoolean:Xo,isObject:Ve,isPlainObject:Le,isUndefined:ke,isDate:Zo,isFile:er,isBlob:tr,isRegExp:yr,isFunction:U,isStream:or,isURLSearchParams:sr,isTypedArray:pr,isFileList:nr,forEach:Te,merge:rt,extend:ar,trim:ir,stripBOM:lr,inherits:cr,toFlatObject:ur,kindOf:He,kindOfTest:x,endsWith:fr,toArray:hr,forEachEntry:dr,matchAll:mr,isHTMLForm:gr,hasOwnProperty:At,hasOwnProp:At,reduceDescriptors:En,freezeMethods:_r,toObjectSet:wr,toCamelCase:br,noop:kr,toFiniteNumber:Er,findKey:_n,global:wn,isContextDefined:kn,ALPHABET:Sn,generateString:Sr,isSpecCompliantForm:Tr,toJSONObject:vr,isAsyncFn:Or,isThenable:Ar};function T(t,e,n,o,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),o&&(this.request=o),r&&(this.response=r)}d.inherits(T,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:d.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Tn=T.prototype,vn={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{vn[t]={value:t}});Object.defineProperties(T,vn);Object.defineProperty(Tn,"isAxiosError",{value:!0});T.from=(t,e,n,o,r,s)=>{const i=Object.create(Tn);return d.toFlatObject(t,i,function(a){return a!==Error.prototype},a=>a!=="isAxiosError"),T.call(i,t.message,e,n,o,r),i.cause=t,i.name=t.name,s&&Object.assign(i,s),i};const Nr=null;function st(t){return d.isPlainObject(t)||d.isArray(t)}function On(t){return d.endsWith(t,"[]")?t.slice(0,-2):t}function Ct(t,e,n){return t?t.concat(e).map(function(o,r){return o=On(o),!n&&r?"["+o+"]":o}).join(n?".":""):e}function Cr(t){return d.isArray(t)&&!t.some(st)}const Pr=d.toFlatObject(d,{},null,function(t){return/^is[A-Z]/.test(t)});function We(t,e,n){if(!d.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=d.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(h,y){return!d.isUndefined(y[h])});const o=n.metaTokens,r=n.visitor||c,s=n.dots,i=n.indexes,a=(n.Blob||typeof Blob<"u"&&Blob)&&d.isSpecCompliantForm(e);if(!d.isFunction(r))throw new TypeError("visitor must be a function");function u(h){if(h===null)return"";if(d.isDate(h))return h.toISOString();if(!a&&d.isBlob(h))throw new T("Blob is not supported. Use a Buffer instead.");return d.isArrayBuffer(h)||d.isTypedArray(h)?a&&typeof Blob=="function"?new Blob([h]):Buffer.from(h):h}function c(h,y,m){let g=h;if(h&&!m&&typeof h=="object"){if(d.endsWith(y,"{}"))y=o?y:y.slice(0,-2),h=JSON.stringify(h);else if(d.isArray(h)&&Cr(h)||(d.isFileList(h)||d.endsWith(y,"[]"))&&(g=d.toArray(h)))return y=On(y),g.forEach(function(E,K){!(d.isUndefined(E)||E===null)&&e.append(i===!0?Ct([y],K,s):i===null?y:y+"[]",u(E))}),!1}return st(h)?!0:(e.append(Ct(m,y,s),u(h)),!1)}const l=[],p=Object.assign(Pr,{defaultVisitor:c,convertValue:u,isVisitable:st});function b(h,y){if(!d.isUndefined(h)){if(l.indexOf(h)!==-1)throw Error("Circular reference detected in "+y.join("."));l.push(h),d.forEach(h,function(m,g){(!(d.isUndefined(m)||m===null)&&r.call(e,m,d.isString(g)?g.trim():g,y,p))===!0&&b(m,y?y.concat(g):[g])}),l.pop()}}if(!d.isObject(t))throw new TypeError("data must be an object");return b(t),e}function Pt(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function yt(t,e){this._pairs=[],t&&We(t,this,e)}const An=yt.prototype;An.append=function(t,e){this._pairs.push([t,e])};An.toString=function(t){const e=t?function(n){return t.call(this,n,Pt)}:Pt;return this._pairs.map(function(n){return e(n[0])+"="+e(n[1])},"").join("&")};function Br(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Nn(t,e,n){if(!e)return t;const o=n&&n.encode||Br,r=n&&n.serialize;let s;if(r?s=r(e,n):s=d.isURLSearchParams(e)?e.toString():new yt(e,n).toString(o),s){const i=t.indexOf("#");i!==-1&&(t=t.slice(0,i)),t+=(t.indexOf("?")===-1?"?":"&")+s}return t}class Rr{constructor(){this.handlers=[]}use(e,n,o){return this.handlers.push({fulfilled:e,rejected:n,synchronous:o?o.synchronous:!1,runWhen:o?o.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){d.forEach(this.handlers,function(n){n!==null&&e(n)})}}const Bt=Rr,Cn={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Lr=typeof URLSearchParams<"u"?URLSearchParams:yt,Dr=typeof FormData<"u"?FormData:null,jr=typeof Blob<"u"?Blob:null,Fr=(()=>{let t;return typeof navigator<"u"&&((t=navigator.product)==="ReactNative"||t==="NativeScript"||t==="NS")?!1:typeof window<"u"&&typeof document<"u"})(),qr=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),W={isBrowser:!0,classes:{URLSearchParams:Lr,FormData:Dr,Blob:jr},isStandardBrowserEnv:Fr,isStandardBrowserWebWorkerEnv:qr,protocols:["http","https","file","blob","url","data"]};function Mr(t,e){return We(t,new W.classes.URLSearchParams,Object.assign({visitor:function(n,o,r,s){return W.isNode&&d.isBuffer(n)?(this.append(o,n.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},e))}function Ur(t){return d.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Ir(t){const e={},n=Object.keys(t);let o;const r=n.length;let s;for(o=0;o<r;o++)s=n[o],e[s]=t[s];return e}function Pn(t){function e(n,o,r,s){let i=n[s++];const a=Number.isFinite(+i),u=s>=n.length;return i=!i&&d.isArray(r)?r.length:i,u?(d.hasOwnProp(r,i)?r[i]=[r[i],o]:r[i]=o,!a):((!r[i]||!d.isObject(r[i]))&&(r[i]=[]),e(n,o,r[i],s)&&d.isArray(r[i])&&(r[i]=Ir(r[i])),!a)}if(d.isFormData(t)&&d.isFunction(t.entries)){const n={};return d.forEachEntry(t,(o,r)=>{e(Ur(o),r,n,0)}),n}return null}function $r(t,e,n){if(d.isString(t))try{return(e||JSON.parse)(t),d.trim(t)}catch(o){if(o.name!=="SyntaxError")throw o}return(n||JSON.stringify)(t)}const _t={transitional:Cn,adapter:["xhr","http"],transformRequest:[function(t,e){const n=e.getContentType()||"",o=n.indexOf("application/json")>-1,r=d.isObject(t);if(r&&d.isHTMLForm(t)&&(t=new FormData(t)),d.isFormData(t))return o&&o?JSON.stringify(Pn(t)):t;if(d.isArrayBuffer(t)||d.isBuffer(t)||d.isStream(t)||d.isFile(t)||d.isBlob(t))return t;if(d.isArrayBufferView(t))return t.buffer;if(d.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let s;if(r){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Mr(t,this.formSerializer).toString();if((s=d.isFileList(t))||n.indexOf("multipart/form-data")>-1){const i=this.env&&this.env.FormData;return We(s?{"files[]":t}:t,i&&new i,this.formSerializer)}}return r||o?(e.setContentType("application/json",!1),$r(t)):t}],transformResponse:[function(t){const e=this.transitional||_t.transitional,n=e&&e.forcedJSONParsing,o=this.responseType==="json";if(t&&d.isString(t)&&(n&&!this.responseType||o)){const r=!(e&&e.silentJSONParsing)&&o;try{return JSON.parse(t)}catch(s){if(r)throw s.name==="SyntaxError"?T.from(s,T.ERR_BAD_RESPONSE,this,null,this.response):s}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:W.classes.FormData,Blob:W.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};d.forEach(["delete","get","head","post","put","patch"],t=>{_t.headers[t]={}});const wt=_t,Hr=d.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),zr=t=>{const e={};let n,o,r;return t&&t.split(`
`).forEach(function(s){r=s.indexOf(":"),n=s.substring(0,r).trim().toLowerCase(),o=s.substring(r+1).trim(),!(!n||e[n]&&Hr[n])&&(n==="set-cookie"?e[n]?e[n].push(o):e[n]=[o]:e[n]=e[n]?e[n]+", "+o:o)}),e},Rt=Symbol("internals");function be(t){return t&&String(t).trim().toLowerCase()}function De(t){return t===!1||t==null?t:d.isArray(t)?t.map(De):String(t)}function Vr(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let o;for(;o=n.exec(t);)e[o[1]]=o[2];return e}const Wr=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Je(t,e,n,o,r){if(d.isFunction(o))return o.call(this,e,n);if(r&&(e=n),!!d.isString(e)){if(d.isString(o))return e.indexOf(o)!==-1;if(d.isRegExp(o))return o.test(e)}}function xr(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,o)=>n.toUpperCase()+o)}function Kr(t,e){const n=d.toCamelCase(" "+e);["get","set","has"].forEach(o=>{Object.defineProperty(t,o+n,{value:function(r,s,i){return this[o].call(this,e,r,s,i)},configurable:!0})})}let xe=class{constructor(t){t&&this.set(t)}set(t,e,n){const o=this;function r(i,a,u){const c=be(a);if(!c)throw new Error("header name must be a non-empty string");const l=d.findKey(o,c);(!l||o[l]===void 0||u===!0||u===void 0&&o[l]!==!1)&&(o[l||a]=De(i))}const s=(i,a)=>d.forEach(i,(u,c)=>r(u,c,a));return d.isPlainObject(t)||t instanceof this.constructor?s(t,e):d.isString(t)&&(t=t.trim())&&!Wr(t)?s(zr(t),e):t!=null&&r(e,t,n),this}get(t,e){if(t=be(t),t){const n=d.findKey(this,t);if(n){const o=this[n];if(!e)return o;if(e===!0)return Vr(o);if(d.isFunction(e))return e.call(this,o,n);if(d.isRegExp(e))return e.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=be(t),t){const n=d.findKey(this,t);return!!(n&&this[n]!==void 0&&(!e||Je(this,this[n],n,e)))}return!1}delete(t,e){const n=this;let o=!1;function r(s){if(s=be(s),s){const i=d.findKey(n,s);i&&(!e||Je(n,n[i],i,e))&&(delete n[i],o=!0)}}return d.isArray(t)?t.forEach(r):r(t),o}clear(t){const e=Object.keys(this);let n=e.length,o=!1;for(;n--;){const r=e[n];(!t||Je(this,this[r],r,t,!0))&&(delete this[r],o=!0)}return o}normalize(t){const e=this,n={};return d.forEach(this,(o,r)=>{const s=d.findKey(n,r);if(s){e[s]=De(o),delete e[r];return}const i=t?xr(r):String(r).trim();i!==r&&delete e[r],e[i]=De(o),n[i]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const e=Object.create(null);return d.forEach(this,(n,o)=>{n!=null&&n!==!1&&(e[o]=t&&d.isArray(n)?n.join(", "):n)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,e])=>t+": "+e).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...e){const n=new this(t);return e.forEach(o=>n.set(o)),n}static accessor(t){const e=(this[Rt]=this[Rt]={accessors:{}}).accessors,n=this.prototype;function o(r){const s=be(r);e[s]||(Kr(n,r),e[s]=!0)}return d.isArray(t)?t.forEach(o):o(t),this}};xe.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);d.reduceDescriptors(xe.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(o){this[n]=o}}});d.freezeMethods(xe);const J=xe;function Qe(t,e){const n=this||wt,o=e||n,r=J.from(o.headers);let s=o.data;return d.forEach(t,function(i){s=i.call(n,s,r.normalize(),e?e.status:void 0)}),r.normalize(),s}function Bn(t){return!!(t&&t.__CANCEL__)}function ve(t,e,n){T.call(this,t??"canceled",T.ERR_CANCELED,e,n),this.name="CanceledError"}d.inherits(ve,T,{__CANCEL__:!0});function Gr(t,e,n){const o=n.config.validateStatus;!n.status||!o||o(n.status)?t(n):e(new T("Request failed with status code "+n.status,[T.ERR_BAD_REQUEST,T.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}const Jr=W.isStandardBrowserEnv?function(){return{write:function(t,e,n,o,r,s){const i=[];i.push(t+"="+encodeURIComponent(e)),d.isNumber(n)&&i.push("expires="+new Date(n).toGMTString()),d.isString(o)&&i.push("path="+o),d.isString(r)&&i.push("domain="+r),s===!0&&i.push("secure"),document.cookie=i.join("; ")},read:function(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function Qr(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function Yr(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}function Rn(t,e){return t&&!Qr(e)?Yr(t,e):e}const Xr=W.isStandardBrowserEnv?function(){const t=/(msie|trident)/i.test(navigator.userAgent),e=document.createElement("a");let n;function o(r){let s=r;return t&&(e.setAttribute("href",s),s=e.href),e.setAttribute("href",s),{href:e.href,protocol:e.protocol?e.protocol.replace(/:$/,""):"",host:e.host,search:e.search?e.search.replace(/^\?/,""):"",hash:e.hash?e.hash.replace(/^#/,""):"",hostname:e.hostname,port:e.port,pathname:e.pathname.charAt(0)==="/"?e.pathname:"/"+e.pathname}}return n=o(window.location.href),function(r){const s=d.isString(r)?o(r):r;return s.protocol===n.protocol&&s.host===n.host}}():function(){return function(){return!0}}();function Zr(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function es(t,e){t=t||10;const n=new Array(t),o=new Array(t);let r=0,s=0,i;return e=e!==void 0?e:1e3,function(a){const u=Date.now(),c=o[s];i||(i=u),n[r]=a,o[r]=u;let l=s,p=0;for(;l!==r;)p+=n[l++],l=l%t;if(r=(r+1)%t,r===s&&(s=(s+1)%t),u-i<e)return;const b=c&&u-c;return b?Math.round(p*1e3/b):void 0}}function Lt(t,e){let n=0;const o=es(50,250);return r=>{const s=r.loaded,i=r.lengthComputable?r.total:void 0,a=s-n,u=o(a),c=s<=i;n=s;const l={loaded:s,total:i,progress:i?s/i:void 0,bytes:a,rate:u||void 0,estimated:u&&i&&c?(i-s)/u:void 0,event:r};l[e?"download":"upload"]=!0,t(l)}}const ts=typeof XMLHttpRequest<"u",ns=ts&&function(t){return new Promise(function(e,n){let o=t.data;const r=J.from(t.headers).normalize(),s=t.responseType;let i;function a(){t.cancelToken&&t.cancelToken.unsubscribe(i),t.signal&&t.signal.removeEventListener("abort",i)}let u;d.isFormData(o)&&(W.isStandardBrowserEnv||W.isStandardBrowserWebWorkerEnv?r.setContentType(!1):r.getContentType(/^\s*multipart\/form-data/)?d.isString(u=r.getContentType())&&r.setContentType(u.replace(/^\s*(multipart\/form-data);+/,"$1")):r.setContentType("multipart/form-data"));let c=new XMLHttpRequest;if(t.auth){const h=t.auth.username||"",y=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";r.set("Authorization","Basic "+btoa(h+":"+y))}const l=Rn(t.baseURL,t.url);c.open(t.method.toUpperCase(),Nn(l,t.params,t.paramsSerializer),!0),c.timeout=t.timeout;function p(){if(!c)return;const h=J.from("getAllResponseHeaders"in c&&c.getAllResponseHeaders()),y={data:!s||s==="text"||s==="json"?c.responseText:c.response,status:c.status,statusText:c.statusText,headers:h,config:t,request:c};Gr(function(m){e(m),a()},function(m){n(m),a()},y),c=null}if("onloadend"in c?c.onloadend=p:c.onreadystatechange=function(){!c||c.readyState!==4||c.status===0&&!(c.responseURL&&c.responseURL.indexOf("file:")===0)||setTimeout(p)},c.onabort=function(){c&&(n(new T("Request aborted",T.ECONNABORTED,t,c)),c=null)},c.onerror=function(){n(new T("Network Error",T.ERR_NETWORK,t,c)),c=null},c.ontimeout=function(){let h=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const y=t.transitional||Cn;t.timeoutErrorMessage&&(h=t.timeoutErrorMessage),n(new T(h,y.clarifyTimeoutError?T.ETIMEDOUT:T.ECONNABORTED,t,c)),c=null},W.isStandardBrowserEnv){const h=(t.withCredentials||Xr(l))&&t.xsrfCookieName&&Jr.read(t.xsrfCookieName);h&&r.set(t.xsrfHeaderName,h)}o===void 0&&r.setContentType(null),"setRequestHeader"in c&&d.forEach(r.toJSON(),function(h,y){c.setRequestHeader(y,h)}),d.isUndefined(t.withCredentials)||(c.withCredentials=!!t.withCredentials),s&&s!=="json"&&(c.responseType=t.responseType),typeof t.onDownloadProgress=="function"&&c.addEventListener("progress",Lt(t.onDownloadProgress,!0)),typeof t.onUploadProgress=="function"&&c.upload&&c.upload.addEventListener("progress",Lt(t.onUploadProgress)),(t.cancelToken||t.signal)&&(i=h=>{c&&(n(!h||h.type?new ve(null,t,c):h),c.abort(),c=null)},t.cancelToken&&t.cancelToken.subscribe(i),t.signal&&(t.signal.aborted?i():t.signal.addEventListener("abort",i)));const b=Zr(l);if(b&&W.protocols.indexOf(b)===-1){n(new T("Unsupported protocol "+b+":",T.ERR_BAD_REQUEST,t));return}c.send(o||null)})},it={http:Nr,xhr:ns};d.forEach(it,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const Dt=t=>`- ${t}`,os=t=>d.isFunction(t)||t===null||t===!1,Ln={getAdapter:t=>{t=d.isArray(t)?t:[t];const{length:e}=t;let n,o;const r={};for(let s=0;s<e;s++){n=t[s];let i;if(o=n,!os(n)&&(o=it[(i=String(n)).toLowerCase()],o===void 0))throw new T(`Unknown adapter '${i}'`);if(o)break;r[i||"#"+s]=o}if(!o){const s=Object.entries(r).map(([a,u])=>`adapter ${a} `+(u===!1?"is not supported by the environment":"is not available in the build"));let i=e?s.length>1?`since :
`+s.map(Dt).join(`
`):" "+Dt(s[0]):"as no adapter specified";throw new T("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return o},adapters:it};function Ye(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new ve(null,t)}function jt(t){return Ye(t),t.headers=J.from(t.headers),t.data=Qe.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),Ln.getAdapter(t.adapter||wt.adapter)(t).then(function(e){return Ye(t),e.data=Qe.call(t,t.transformResponse,e),e.headers=J.from(e.headers),e},function(e){return Bn(e)||(Ye(t),e&&e.response&&(e.response.data=Qe.call(t,t.transformResponse,e.response),e.response.headers=J.from(e.response.headers))),Promise.reject(e)})}const Ft=t=>t instanceof J?t.toJSON():t;function ie(t,e){e=e||{};const n={};function o(c,l,p){return d.isPlainObject(c)&&d.isPlainObject(l)?d.merge.call({caseless:p},c,l):d.isPlainObject(l)?d.merge({},l):d.isArray(l)?l.slice():l}function r(c,l,p){if(d.isUndefined(l)){if(!d.isUndefined(c))return o(void 0,c,p)}else return o(c,l,p)}function s(c,l){if(!d.isUndefined(l))return o(void 0,l)}function i(c,l){if(d.isUndefined(l)){if(!d.isUndefined(c))return o(void 0,c)}else return o(void 0,l)}function a(c,l,p){if(p in e)return o(c,l);if(p in t)return o(void 0,c)}const u={url:s,method:s,data:s,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:a,headers:(c,l)=>r(Ft(c),Ft(l),!0)};return d.forEach(Object.keys(Object.assign({},t,e)),function(c){const l=u[c]||r,p=l(t[c],e[c],c);d.isUndefined(p)&&l!==a||(n[c]=p)}),n}const Dn="1.5.1",kt={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{kt[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});const qt={};kt.transitional=function(t,e,n){function o(r,s){return"[Axios v"+Dn+"] Transitional option '"+r+"'"+s+(n?". "+n:"")}return(r,s,i)=>{if(t===!1)throw new T(o(s," has been removed"+(e?" in "+e:"")),T.ERR_DEPRECATED);return e&&!qt[s]&&(qt[s]=!0,console.warn(o(s," has been deprecated since v"+e+" and will be removed in the near future"))),t?t(r,s,i):!0}};function rs(t,e,n){if(typeof t!="object")throw new T("options must be an object",T.ERR_BAD_OPTION_VALUE);const o=Object.keys(t);let r=o.length;for(;r-- >0;){const s=o[r],i=e[s];if(i){const a=t[s],u=a===void 0||i(a,s,t);if(u!==!0)throw new T("option "+s+" must be "+u,T.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new T("Unknown option "+s,T.ERR_BAD_OPTION)}}const at={assertOptions:rs,validators:kt},Q=at.validators;let qe=class{constructor(t){this.defaults=t,this.interceptors={request:new Bt,response:new Bt}}request(t,e){typeof t=="string"?(e=e||{},e.url=t):e=t||{},e=ie(this.defaults,e);const{transitional:n,paramsSerializer:o,headers:r}=e;n!==void 0&&at.assertOptions(n,{silentJSONParsing:Q.transitional(Q.boolean),forcedJSONParsing:Q.transitional(Q.boolean),clarifyTimeoutError:Q.transitional(Q.boolean)},!1),o!=null&&(d.isFunction(o)?e.paramsSerializer={serialize:o}:at.assertOptions(o,{encode:Q.function,serialize:Q.function},!0)),e.method=(e.method||this.defaults.method||"get").toLowerCase();let s=r&&d.merge(r.common,r[e.method]);r&&d.forEach(["delete","get","head","post","put","patch","common"],h=>{delete r[h]}),e.headers=J.concat(s,r);const i=[];let a=!0;this.interceptors.request.forEach(function(h){typeof h.runWhen=="function"&&h.runWhen(e)===!1||(a=a&&h.synchronous,i.unshift(h.fulfilled,h.rejected))});const u=[];this.interceptors.response.forEach(function(h){u.push(h.fulfilled,h.rejected)});let c,l=0,p;if(!a){const h=[jt.bind(this),void 0];for(h.unshift.apply(h,i),h.push.apply(h,u),p=h.length,c=Promise.resolve(e);l<p;)c=c.then(h[l++],h[l++]);return c}p=i.length;let b=e;for(l=0;l<p;){const h=i[l++],y=i[l++];try{b=h(b)}catch(m){y.call(this,m);break}}try{c=jt.call(this,b)}catch(h){return Promise.reject(h)}for(l=0,p=u.length;l<p;)c=c.then(u[l++],u[l++]);return c}getUri(t){t=ie(this.defaults,t);const e=Rn(t.baseURL,t.url);return Nn(e,t.params,t.paramsSerializer)}};d.forEach(["delete","get","head","options"],function(t){qe.prototype[t]=function(e,n){return this.request(ie(n||{},{method:t,url:e,data:(n||{}).data}))}});d.forEach(["post","put","patch"],function(t){function e(n){return function(o,r,s){return this.request(ie(s||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:o,data:r}))}}qe.prototype[t]=e(),qe.prototype[t+"Form"]=e(!0)});const je=qe;let ss=class jn{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(r){n=r});const o=this;this.promise.then(r=>{if(!o._listeners)return;let s=o._listeners.length;for(;s-- >0;)o._listeners[s](r);o._listeners=null}),this.promise.then=r=>{let s;const i=new Promise(a=>{o.subscribe(a),s=a}).then(r);return i.cancel=function(){o.unsubscribe(s)},i},e(function(r,s,i){o.reason||(o.reason=new ve(r,s,i),n(o.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}static source(){let e;return{token:new jn(function(n){e=n}),cancel:e}}};const is=ss;function as(t){return function(e){return t.apply(null,e)}}function ls(t){return d.isObject(t)&&t.isAxiosError===!0}const lt={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(lt).forEach(([t,e])=>{lt[e]=t});const cs=lt;function Fn(t){const e=new je(t),n=gn(je.prototype.request,e);return d.extend(n,je.prototype,e,{allOwnKeys:!0}),d.extend(n,e,null,{allOwnKeys:!0}),n.create=function(o){return Fn(ie(t,o))},n}const L=Fn(wt);L.Axios=je;L.CanceledError=ve;L.CancelToken=is;L.isCancel=Bn;L.VERSION=Dn;L.toFormData=We;L.AxiosError=T;L.Cancel=L.CanceledError;L.all=function(t){return Promise.all(t)};L.spread=as;L.isAxiosError=ls;L.mergeConfig=ie;L.AxiosHeaders=J;L.formToJSON=t=>Pn(d.isHTMLForm(t)?new FormData(t):t);L.getAdapter=Ln.getAdapter;L.HttpStatusCode=cs;L.default=L;const qn=L,{Axios:Vi,AxiosError:Wi,CanceledError:xi,isCancel:Ki,CancelToken:Gi,VERSION:Ji,all:Qi,Cancel:Yi,isAxiosError:Xi,spread:Zi,toFormData:ea,AxiosHeaders:ta,HttpStatusCode:Be,formToJSON:na,getAdapter:oa,mergeConfig:ra}=qn;var ne=null;typeof WebSocket<"u"?ne=WebSocket:typeof MozWebSocket<"u"?ne=MozWebSocket:typeof global<"u"?ne=global.WebSocket||global.MozWebSocket:typeof window<"u"?ne=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(ne=self.WebSocket||self.MozWebSocket);const us=ne,Xe={SCHEMA_DIR_RELATIVE_PATH:"./../schemas/",SCHEMA_FILENAME_PAYLOAD:"payload.schema.json",SCHEMA_FILENAME_RESPONSE:"response.schema.json",SIYUAN_DEFAULT_BASE_URL:"http://localhost:6806/",SIYUAN_DEFAULT_TOKEN:"",REQUEST_TIMEOUT:6e4};var Mt,Ut,It,$t,Ht;const ct=class f{constructor(e={},n="xhr"){G(this,"_type","xhr"),G(this,"_baseURL",((Ut=(Mt=globalThis.top)==null?void 0:Mt.document)==null?void 0:Ut.baseURI)??(($t=(It=globalThis.parent)==null?void 0:It.document)==null?void 0:$t.baseURI)??((Ht=globalThis.location)==null?void 0:Ht.origin)??Xe.SIYUAN_DEFAULT_BASE_URL),G(this,"_token",Xe.SIYUAN_DEFAULT_TOKEN),G(this,"_axios",qn.create({baseURL:this._baseURL,timeout:Xe.REQUEST_TIMEOUT,headers:{Authorization:`Token ${this._token}`}})),G(this,"_fetch",Wo.create({baseURL:this._baseURL,headers:{Authorization:`Token ${this._token}`}})),this._setClientType(n),this._updateOptions(e,n)}_setClientType(e){this._type=e}_updateOptions(e,n=this._type){switch(this._token=e.token??this._token,this._baseURL=e.baseURL??this._baseURL,n){case"fetch":const o=e;if(o.token){const r="Authorization",s=`Token ${e.token}`;Array.isArray(o.headers)?o.headers.push([r,s]):o.headers instanceof Headers?o.headers.set(r,s):typeof o.headers=="object"?o.headers[r]=s:o.headers={[r]:s},delete e.token}this._fetch=this._fetch.create(o);break;case"xhr":default:for(const[r,s]of Object.entries(e))switch(r){case"token":this._axios.defaults.headers.Authorization=`Token ${this._token}`;break;default:this._axios.defaults[r]=s;break}break}this._baseURL=e.baseURL??this._baseURL}broadcast(e,n,o){const r=(o==null?void 0:o.baseURL)??this._baseURL,s=(o==null?void 0:o.token)??this._token,i=new URLSearchParams(e);i.set("token",s);const a=new URL(r);return a.protocol=a.protocol.replace(/^http/,"ws"),a.pathname=a.pathname.endsWith("/")?`${a.pathname}${f.ws.broadcast.pathname.substring(1)}`:`${a.pathname}${f.ws.broadcast.pathname}`,a.search=i.toString(),new us(a,n)}async upload(e,n){const o=new FormData;return o.append("assetsDirPath",e.assetsDirPath??"/assets/"),e.files.forEach(r=>o.append("file[]",r)),await this._request(f.api.asset.upload.pathname,f.api.asset.upload.method,o,n)}async getBlockAttrs(e,n){return await this._request(f.api.attr.getBlockAttrs.pathname,f.api.attr.getBlockAttrs.method,e,n)}async getBookmarkLabels(e){return await this._request(f.api.attr.getBookmarkLabels.pathname,f.api.attr.getBookmarkLabels.method,void 0,e)}async setBlockAttrs(e,n){return await this._request(f.api.attr.setBlockAttrs.pathname,f.api.attr.setBlockAttrs.method,e,n)}async appendBlock(e,n){return await this._request(f.api.block.appendBlock.pathname,f.api.block.appendBlock.method,e,n)}async deleteBlock(e,n){return await this._request(f.api.block.deleteBlock.pathname,f.api.block.deleteBlock.method,e,n)}async getBlockBreadcrumb(e,n){return await this._request(f.api.block.getBlockBreadcrumb.pathname,f.api.block.getBlockBreadcrumb.method,e,n)}async getBlockDOM(e,n){return await this._request(f.api.block.getBlockDOM.pathname,f.api.block.getBlockDOM.method,e,n)}async getBlockInfo(e,n){return await this._request(f.api.block.getBlockInfo.pathname,f.api.block.getBlockInfo.method,e,n)}async getBlockKramdown(e,n){return await this._request(f.api.block.getBlockKramdown.pathname,f.api.block.getBlockKramdown.method,e,n)}async getChildBlocks(e,n){return await this._request(f.api.block.getChildBlocks.pathname,f.api.block.getChildBlocks.method,e,n)}async getDocInfo(e,n){return await this._request(f.api.block.getDocInfo.pathname,f.api.block.getDocInfo.method,e,n)}async insertBlock(e,n){return await this._request(f.api.block.insertBlock.pathname,f.api.block.insertBlock.method,e,n)}async moveBlock(e,n){return await this._request(f.api.block.moveBlock.pathname,f.api.block.moveBlock.method,e,n)}async prependBlock(e,n){return await this._request(f.api.block.prependBlock.pathname,f.api.block.prependBlock.method,e,n)}async transferBlockRef(e,n){return await this._request(f.api.block.transferBlockRef.pathname,f.api.block.transferBlockRef.method,e,n)}async updateBlock(e,n){return await this._request(f.api.block.updateBlock.pathname,f.api.block.updateBlock.method,e,n)}async channels(e){return await this._request(f.api.broadcast.channels.pathname,f.api.broadcast.channels.method,void 0,e)}async getChannelInfo(e,n){return await this._request(f.api.broadcast.getChannelInfo.pathname,f.api.broadcast.getChannelInfo.method,e,n)}async postMessage(e,n){return await this._request(f.api.broadcast.postMessage.pathname,f.api.broadcast.postMessage.method,e,n)}async pandoc(e,n){return await this._request(f.api.convert.pandoc.pathname,f.api.convert.pandoc.method,e,n)}async exportResources(e,n){return await this._request(f.api.export.exportResources.pathname,f.api.export.exportResources.method,e,n)}async exportMdContent(e,n){return await this._request(f.api.export.exportMdContent.pathname,f.api.export.exportMdContent.method,e,n)}async getFile(e,n="text",o){return await this._request(f.api.file.getFile.pathname,f.api.file.getFile.method,e,o,!1,n)}async putFile(e,n){e.file!==void 0&&!(e.file instanceof File)&&(e.file=new File([e.file],e.path.split("/").pop()));const o=new FormData;for(const[r,s]of Object.entries(e))e.hasOwnProperty(r)&&(s instanceof Blob?o.append(r,s):o.append(r,String(s)));return await this._request(f.api.file.putFile.pathname,f.api.file.putFile.method,o,n)}async readDir(e,n){return await this._request(f.api.file.readDir.pathname,f.api.file.readDir.method,e,n)}async removeFile(e,n){return await this._request(f.api.file.removeFile.pathname,f.api.file.removeFile.method,e,n)}async renameFile(e,n){return await this._request(f.api.file.renameFile.pathname,f.api.file.renameFile.method,e,n)}async createDocWithMd(e,n){return await this._request(f.api.filetree.createDocWithMd.pathname,f.api.filetree.createDocWithMd.method,e,n)}async getDoc(e,n){return await this._request(f.api.filetree.getDoc.pathname,f.api.filetree.getDoc.method,e,n)}async getHPathByID(e,n){return await this._request(f.api.filetree.getHPathByID.pathname,f.api.filetree.getHPathByID.method,e,n)}async getHPathByPath(e,n){return await this._request(f.api.filetree.getHPathByPath.pathname,f.api.filetree.getHPathByPath.method,e,n)}async listDocsByPath(e,n){return await this._request(f.api.filetree.listDocsByPath.pathname,f.api.filetree.listDocsByPath.method,e,n)}async moveDocs(e,n){return await this._request(f.api.filetree.moveDocs.pathname,f.api.filetree.moveDocs.method,e,n)}async removeDoc(e,n){return await this._request(f.api.filetree.removeDoc.pathname,f.api.filetree.removeDoc.method,e,n)}async renameDoc(e,n){return await this._request(f.api.filetree.renameDoc.pathname,f.api.filetree.renameDoc.method,e,n)}async searchDocs(e,n){return await this._request(f.api.filetree.searchDocs.pathname,f.api.filetree.searchDocs.method,e,n)}async getDocHistoryContent(e,n){return await this._request(f.api.history.getDocHistoryContent.pathname,f.api.history.getDocHistoryContent.method,e,n)}async getHistoryItems(e,n){return await this._request(f.api.history.getHistoryItems.pathname,f.api.history.getHistoryItems.method,e,n)}async getShorthand(e,n){return await this._request(f.api.inbox.getShorthand.pathname,f.api.inbox.getShorthand.method,e,n)}async forwardProxy(e,n){return await this._request(f.api.network.forwardProxy.pathname,f.api.network.forwardProxy.method,e,n)}async closeNotebook(e,n){return await this._request(f.api.notebook.closeNotebook.pathname,f.api.notebook.closeNotebook.method,e,n)}async createNotebook(e,n){return await this._request(f.api.notebook.createNotebook.pathname,f.api.notebook.createNotebook.method,e,n)}async getNotebookConf(e,n){return await this._request(f.api.notebook.getNotebookConf.pathname,f.api.notebook.getNotebookConf.method,e,n)}async lsNotebooks(e){return await this._request(f.api.notebook.lsNotebooks.pathname,f.api.notebook.lsNotebooks.method,void 0,e)}async openNotebook(e,n){return await this._request(f.api.notebook.openNotebook.pathname,f.api.notebook.openNotebook.method,e,n)}async removeNotebook(e,n){return await this._request(f.api.notebook.removeNotebook.pathname,f.api.notebook.removeNotebook.method,e,n)}async renameNotebook(e,n){return await this._request(f.api.notebook.renameNotebook.pathname,f.api.notebook.renameNotebook.method,e,n)}async setNotebookConf(e,n){return await this._request(f.api.notebook.setNotebookConf.pathname,f.api.notebook.setNotebookConf.method,e,n)}async pushErrMsg(e,n){return await this._request(f.api.notification.pushErrMsg.pathname,f.api.notification.pushErrMsg.method,e,n)}async pushMsg(e,n){return await this._request(f.api.notification.pushMsg.pathname,f.api.notification.pushMsg.method,e,n)}async sql(e,n){return await this._request(f.api.query.sql.pathname,f.api.query.sql.method,e,n)}async openRepoSnapshotDoc(e,n){return await this._request(f.api.repo.openRepoSnapshotDoc.pathname,f.api.repo.openRepoSnapshotDoc.method,e,n)}async fullTextSearchBlock(e,n){return await this._request(f.api.search.fullTextSearchBlock.pathname,f.api.search.fullTextSearchBlock.method,e,n)}async getSnippet(e,n){return await this._request(f.api.snippet.getSnippet.pathname,f.api.snippet.getSnippet.method,e,n)}async setSnippet(e,n){return await this._request(f.api.snippet.setSnippet.pathname,f.api.snippet.setSnippet.method,e,n)}async getLocalStorage(e){return await this._request(f.api.storage.getLocalStorage.pathname,f.api.storage.getLocalStorage.method,void 0,e)}async getRecentDocs(e){return await this._request(f.api.storage.getRecentDocs.pathname,f.api.storage.getRecentDocs.method,void 0,e)}async setLocalStorage(e,n){return await this._request(f.api.storage.setLocalStorage.pathname,f.api.storage.setLocalStorage.method,e,n)}async bootProgress(e){return await this._request(f.api.system.bootProgress.pathname,f.api.system.bootProgress.method,void 0,e)}async getConf(e){return await this._request(f.api.system.getConf.pathname,f.api.system.getConf.method,void 0,e)}async currentTime(e){return await this._request(f.api.system.currentTime.pathname,f.api.system.currentTime.method,void 0,e)}async version(e){return await this._request(f.api.system.version.pathname,f.api.system.version.method,void 0,e)}async render(e,n){return await this._request(f.api.template.render.pathname,f.api.template.render.method,e,n)}async renderSprig(e,n){return await this._request(f.api.template.renderSprig.pathname,f.api.template.renderSprig.method,e,n)}async _request(e,n,o,r,s=!0,i="json"){try{switch((r==null?void 0:r.type)??this._type){case"fetch":{const a=r==null?void 0:r.options;i=(()=>{switch(i){case"arraybuffer":return"arrayBuffer";case"document":return"text";default:return i}})();const u=await this._fetch(e,{method:n,body:o,responseType:i,onResponse:async c=>{switch(c.response.status){case Be.Ok:break;case Be.Accepted:e===f.api.file.getFile.pathname&&this._parseFetchResponse(c.response._data);break;default:break}},...a});return s&&i==="json"&&typeof u=="object"?this._parseFetchResponse(u):u}case"xhr":default:{const a=r==null?void 0:r.options;i=(()=>{switch(i){case"arrayBuffer":return"arraybuffer";default:return i}})();const u=await this._axios.request({url:e,method:n,data:o,responseType:i,...a});switch(u.status){case Be.Ok:return s&&i==="json"&&typeof u.data=="object"?this._parseAxiosResponse(u):u.data;case Be.Accepted:return e===f.api.file.getFile.pathname?this._parseAxiosResponse(u):u.data;default:throw new xo(u)}}}}catch(a){throw a}}_parseFetchResponse(e){if(e.code===0)return e;throw new vt(e)}_parseAxiosResponse(e){if(e.data.code===0)return e.data;throw new vt(e.data,e)}};G(ct,"ws",{broadcast:{pathname:"/ws/broadcast"}}),G(ct,"api",{asset:{upload:{pathname:"/api/asset/upload",method:"POST"}},attr:{getBlockAttrs:{pathname:"/api/attr/getBlockAttrs",method:"POST"},getBookmarkLabels:{pathname:"/api/attr/getBookmarkLabels",method:"POST"},setBlockAttrs:{pathname:"/api/attr/setBlockAttrs",method:"POST"}},block:{appendBlock:{pathname:"/api/block/appendBlock",method:"POST"},deleteBlock:{pathname:"/api/block/deleteBlock",method:"POST"},getBlockBreadcrumb:{pathname:"/api/block/getBlockBreadcrumb",method:"POST"},getBlockDOM:{pathname:"/api/block/getBlockDOM",method:"POST"},getBlockInfo:{pathname:"/api/block/getBlockInfo",method:"POST"},getBlockKramdown:{pathname:"/api/block/getBlockKramdown",method:"POST"},getChildBlocks:{pathname:"/api/block/getChildBlocks",method:"POST"},getDocInfo:{pathname:"/api/block/getDocInfo",method:"POST"},insertBlock:{pathname:"/api/block/insertBlock",method:"POST"},moveBlock:{pathname:"/api/block/moveBlock",method:"POST"},prependBlock:{pathname:"/api/block/prependBlock",method:"POST"},transferBlockRef:{pathname:"/api/block/transferBlockRef",method:"POST"},updateBlock:{pathname:"/api/block/updateBlock",method:"POST"}},broadcast:{channels:{pathname:"/api/broadcast/channels",method:"GET"},getChannelInfo:{pathname:"/api/broadcast/getChannelInfo",method:"POST"},postMessage:{pathname:"/api/broadcast/postMessage",method:"POST"}},convert:{pandoc:{pathname:"/api/convert/pandoc",method:"POST"}},export:{exportMdContent:{pathname:"/api/export/exportMdContent",method:"POST"},exportResources:{pathname:"/api/export/exportResources",method:"POST"}},file:{getFile:{pathname:"/api/file/getFile",method:"POST"},putFile:{pathname:"/api/file/putFile",method:"POST"},readDir:{pathname:"/api/file/readDir",method:"POST"},removeFile:{pathname:"/api/file/removeFile",method:"POST"},renameFile:{pathname:"/api/file/renameFile",method:"POST"}},filetree:{createDocWithMd:{pathname:"/api/filetree/createDocWithMd",method:"POST"},getDoc:{pathname:"/api/filetree/getDoc",method:"POST"},getHPathByID:{pathname:"/api/filetree/getHPathByID",method:"POST"},getHPathByPath:{pathname:"/api/filetree/getHPathByPath",method:"POST"},listDocsByPath:{pathname:"/api/filetree/listDocsByPath",method:"POST"},moveDocs:{pathname:"/api/filetree/moveDocs",method:"POST"},removeDoc:{pathname:"/api/filetree/removeDoc",method:"POST"},renameDoc:{pathname:"/api/filetree/renameDoc",method:"POST"},searchDocs:{pathname:"/api/filetree/searchDocs",method:"POST"}},history:{getDocHistoryContent:{pathname:"/api/history/getDocHistoryContent",method:"POST"},getHistoryItems:{pathname:"/api/history/getHistoryItems",method:"POST"}},inbox:{getShorthand:{pathname:"/api/inbox/getShorthand",method:"POST"}},network:{forwardProxy:{pathname:"/api/network/forwardProxy",method:"POST"}},notebook:{closeNotebook:{pathname:"/api/notebook/closeNotebook",method:"POST"},createNotebook:{pathname:"/api/notebook/createNotebook",method:"POST"},getNotebookConf:{pathname:"/api/notebook/getNotebookConf",method:"POST"},lsNotebooks:{pathname:"/api/notebook/lsNotebooks",method:"POST"},openNotebook:{pathname:"/api/notebook/openNotebook",method:"POST"},removeNotebook:{pathname:"/api/notebook/removeNotebook",method:"POST"},renameNotebook:{pathname:"/api/notebook/renameNotebook",method:"POST"},setNotebookConf:{pathname:"/api/notebook/setNotebookConf",method:"POST"}},notification:{pushErrMsg:{pathname:"/api/notification/pushErrMsg",method:"POST"},pushMsg:{pathname:"/api/notification/pushMsg",method:"POST"}},query:{sql:{pathname:"/api/query/sql",method:"POST"}},repo:{openRepoSnapshotDoc:{pathname:"/api/repo/openRepoSnapshotDoc",method:"POST"}},search:{fullTextSearchBlock:{pathname:"/api/search/fullTextSearchBlock",method:"POST"}},snippet:{getSnippet:{pathname:"/api/snippet/getSnippet",method:"POST"},setSnippet:{pathname:"/api/snippet/setSnippet",method:"POST"}},storage:{getLocalStorage:{pathname:"/api/storage/getLocalStorage",method:"POST"},getRecentDocs:{pathname:"/api/storage/getRecentDocs",method:"POST"},setLocalStorage:{pathname:"/api/storage/setLocalStorage",method:"POST"}},system:{bootProgress:{pathname:"/api/system/bootProgress",method:"POST"},currentTime:{pathname:"/api/system/currentTime",method:"POST"},getConf:{pathname:"/api/system/getConf",method:"POST"},version:{pathname:"/api/system/version",method:"POST"}},template:{render:{pathname:"/api/template/render",method:"POST"},renderSprig:{pathname:"/api/template/renderSprig",method:"POST"}}});let fs=ct;function Y(){}function hs(t,e){for(const n in e)t[n]=e[n];return t}function Mn(t){return t()}function zt(){return Object.create(null)}function M(t){t.forEach(Mn)}function Un(t){return typeof t=="function"}function pe(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function ps(t){return Object.keys(t).length===0}function ae(t,e,n,o){if(t){const r=In(t,e,n,o);return t[0](r)}}function In(t,e,n,o){return t[1]&&o?hs(n.ctx.slice(),t[1](o(e))):n.ctx}function le(t,e,n,o){if(t[2]&&o){const r=t[2](o(n));if(e.dirty===void 0)return r;if(typeof r=="object"){const s=[],i=Math.max(e.dirty.length,r.length);for(let a=0;a<i;a+=1)s[a]=e.dirty[a]|r[a];return s}return e.dirty|r}return e.dirty}function ce(t,e,n,o,r,s){if(r){const i=In(e,n,o,s);t.p(i,r)}}function ue(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let o=0;o<n;o++)e[o]=-1;return e}return-1}function j(t,e){t.appendChild(e)}function A(t,e,n){t.insertBefore(e,n||null)}function O(t){t.parentNode&&t.parentNode.removeChild(t)}function C(t){return document.createElement(t)}function ut(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function Oe(t){return document.createTextNode(t)}function F(){return Oe(" ")}function Et(){return Oe("")}function D(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function _(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Vt(t,e,n){t.setAttributeNS("http://www.w3.org/1999/xlink",e,n)}function ft(t){return t===""?null:+t}function ds(t){return Array.from(t.childNodes)}function $n(t,e){e=""+e,t.data!==e&&(t.data=e)}function I(t,e){t.value=e??""}function Re(t,e,n,o){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,o?"important":"")}function Wt(t,e,n){for(let o=0;o<t.options.length;o+=1){const r=t.options[o];if(r.__value===e){r.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function ms(t){const e=t.querySelector(":checked");return e&&e.__value}function w(t,e,n){t.classList.toggle(e,!!n)}function gs(t,e,{bubbles:n=!1,cancelable:o=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:o})}class Hn{constructor(e=!1){N(this,"is_svg",!1);N(this,"e");N(this,"n");N(this,"t");N(this,"a");this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,n,o=null){this.e||(this.is_svg?this.e=ut(n.nodeName):this.e=C(n.nodeType===11?"TEMPLATE":n.nodeName),this.t=n.tagName!=="TEMPLATE"?n:n.content,this.c(e)),this.i(o)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let n=0;n<this.n.length;n+=1)A(this.t,this.n[n],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(O)}}let Ee;function _e(t){Ee=t}function bs(){if(!Ee)throw new Error("Function called outside component initialization");return Ee}function zn(){const t=bs();return(e,n,{cancelable:o=!1}={})=>{const r=t.$$.callbacks[e];if(r){const s=gs(e,n,{cancelable:o});return r.slice().forEach(i=>{i.call(t,s)}),!s.defaultPrevented}return!0}}const oe=[],xt=[];let se=[];const Kt=[],ys=Promise.resolve();let ht=!1;function _s(){ht||(ht=!0,ys.then(Vn))}function Me(t){se.push(t)}const Ze=new Set;let te=0;function Vn(){if(te!==0)return;const t=Ee;do{try{for(;te<oe.length;){const e=oe[te];te++,_e(e),ws(e.$$)}}catch(e){throw oe.length=0,te=0,e}for(_e(null),oe.length=0,te=0;xt.length;)xt.pop()();for(let e=0;e<se.length;e+=1){const n=se[e];Ze.has(n)||(Ze.add(n),n())}se.length=0}while(oe.length);for(;Kt.length;)Kt.pop()();ht=!1,Ze.clear(),_e(t)}function ws(t){if(t.fragment!==null){t.update(),M(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Me)}}function ks(t){const e=[],n=[];se.forEach(o=>t.indexOf(o)===-1?e.push(o):n.push(o)),n.forEach(o=>o()),se=e}const Fe=new Set;let Z;function Ue(){Z={r:0,c:[],p:Z}}function Ie(){Z.r||M(Z.c),Z=Z.p}function S(t,e){t&&t.i&&(Fe.delete(t),t.i(e))}function v(t,e,n,o){if(t&&t.o){if(Fe.has(t))return;Fe.add(t),Z.c.push(()=>{Fe.delete(t),o&&(n&&t.d(1),o())}),t.o(e)}else o&&o()}function $e(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function Es(t,e){t.d(1),e.delete(t.key)}function Ss(t,e){v(t,1,1,()=>{e.delete(t.key)})}function Wn(t,e,n,o,r,s,i,a,u,c,l,p){let b=t.length,h=s.length,y=b;const m={};for(;y--;)m[t[y].key]=y;const g=[],E=new Map,K=new Map,Ae=[];for(y=h;y--;){const k=p(r,s,y),$=n(k);let H=i.get($);H?o&&Ae.push(()=>H.p(k,e)):(H=c($,k),H.c()),E.set($,g[y]=H),$ in m&&K.set($,Math.abs(y-m[$]))}const Ne=new Set,Ce=new Set;function ge(k){S(k,1),k.m(a,l),i.set(k.key,k),l=k.first,h--}for(;b&&h;){const k=g[h-1],$=t[b-1],H=k.key,Pe=$.key;k===$?(l=k.first,b--,h--):E.has(Pe)?!i.has(H)||Ne.has(H)?ge(k):Ce.has(Pe)?b--:K.get(H)>K.get(Pe)?(Ce.add(H),ge(k)):(Ne.add(Pe),b--):(u($,i),b--)}for(;b--;){const k=t[b];E.has(k.key)||u(k,i)}for(;h;)ge(g[h-1]);return M(Ae),g}function R(t){t&&t.c()}function P(t,e,n){const{fragment:o,after_update:r}=t.$$;o&&o.m(e,n),Me(()=>{const s=t.$$.on_mount.map(Mn).filter(Un);t.$$.on_destroy?t.$$.on_destroy.push(...s):M(s),t.$$.on_mount=[]}),r.forEach(Me)}function B(t,e){const n=t.$$;n.fragment!==null&&(ks(n.after_update),M(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Ts(t,e){t.$$.dirty[0]===-1&&(oe.push(t),_s(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function de(t,e,n,o,r,s,i=null,a=[-1]){const u=Ee;_e(t);const c=t.$$={fragment:null,ctx:[],props:s,update:Y,not_equal:r,bound:zt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:zt(),dirty:a,skip_bound:!1,root:e.target||u.$$.root};i&&i(c.root);let l=!1;if(c.ctx=n?n(t,e.props||{},(p,b,...h)=>{const y=h.length?h[0]:b;return c.ctx&&r(c.ctx[p],c.ctx[p]=y)&&(!c.skip_bound&&c.bound[p]&&c.bound[p](y),l&&Ts(t,p)),b}):[],c.update(),l=!0,M(c.before_update),c.fragment=o?o(c.ctx):!1,e.target){if(e.hydrate){const p=ds(e.target);c.fragment&&c.fragment.l(p),p.forEach(O)}else c.fragment&&c.fragment.c();e.intro&&S(t.$$.fragment),P(t,e.target,e.anchor),Vn()}_e(u)}class me{constructor(){N(this,"$$");N(this,"$$set")}$destroy(){B(this,1),this.$destroy=Y}$on(e,n){if(!Un(n))return Y;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const r=o.indexOf(n);r!==-1&&o.splice(r,1)}}$set(e){this.$$set&&!ps(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const vs="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(vs);const pt={id:/^\d{14}-[0-9a-z]{7}$/,url:/^siyuan:\/\/blocks\/(\d{14}-[0-9a-z]{7})/,snippet:/^\d{14}-[0-9a-z]{7}$/,created:/^\d{10}$/,history:/[\/\\]history[\/\\]\d{4}-\d{2}-\d{2}-\d{6}-(clean|update|delete|format|sync|replace)([\/\\]\d{14}-[0-9a-z]{7})+\.sy$/,snapshot:/^[0-9a-f]{40}$/,shorthand:/^\d{13}$/};function Os(t){let e,n;return{c(){e=ut("svg"),n=ut("use"),Vt(n,"xlink:href",t[0]),_(e,"style",t[3]),_(e,"data-id",t[1]),_(e,"class",t[2]),w(e,"popover__block",pt.id.test(t[1]))},m(o,r){A(o,e,r),j(e,n)},p(o,[r]){r&1&&Vt(n,"xlink:href",o[0]),r&8&&_(e,"style",o[3]),r&2&&_(e,"data-id",o[1]),r&4&&_(e,"class",o[2]),r&6&&w(e,"popover__block",pt.id.test(o[1]))},i:Y,o:Y,d(o){o&&O(e)}}}function As(t,e,n){let{icon:o}=e,{id:r=""}=e,{className:s=""}=e,{style:i=""}=e;return t.$$set=a=>{"icon"in a&&n(0,o=a.icon),"id"in a&&n(1,r=a.id),"className"in a&&n(2,s=a.className),"style"in a&&n(3,i=a.style)},[o,r,s,i]}class xn extends me{constructor(e){super(),de(this,e,As,Os,pe,{icon:0,id:1,className:2,style:3})}}const Ns=t=>({focus:t&1}),Gt=t=>({focus:t[0]});function Jt(t,e,n){const o=t.slice();return o[13]=e[n],o}function Qt(t){let e,n,o,r,s,i,a;return n=new xn({props:{icon:"#iconSearch",className:"b3-form__icon-icon"}}),{c(){e=C("div"),R(n.$$.fragment),o=F(),r=C("input"),_(r,"placeholder",t[4]),_(r,"class","b3-text-field fn__block b3-form__icon-input"),_(e,"class","b3-form__icon")},m(u,c){A(u,e,c),P(n,e,null),j(e,o),j(e,r),I(r,t[1]),s=!0,i||(a=[D(r,"input",t[9]),D(r,"change",t[5])],i=!0)},p(u,c){(!s||c&16)&&_(r,"placeholder",u[4]),c&2&&r.value!==u[1]&&I(r,u[1])},i(u){s||(S(n.$$.fragment,u),s=!0)},o(u){v(n.$$.fragment,u),s=!1},d(u){u&&O(e),B(n),i=!1,M(a)}}}function Yt(t,e){let n,o,r,s,i=e[13].text+"",a,u,c,l,p;o=new xn({props:{icon:e[13].icon,className:"b3-list-item__graphic"}});function b(){return e[10](e[13])}function h(){return e[11](e[13])}return{key:t,first:null,c(){n=C("li"),R(o.$$.fragment),r=F(),s=C("span"),a=F(),_(s,"class","b3-list-item__text svelte-15drd7h"),_(n,"role","button"),_(n,"data-name",u=e[13].name),_(n,"class","b3-list-item"),w(n,"b3-list-item--focus",e[13].key===e[0]),this.first=n},m(y,m){A(y,n,m),P(o,n,null),j(n,r),j(n,s),s.innerHTML=i,j(n,a),c=!0,l||(p=[D(n,"click",b),D(n,"keyup",h)],l=!0)},p(y,m){e=y;const g={};m&4&&(g.icon=e[13].icon),o.$set(g),(!c||m&4)&&i!==(i=e[13].text+"")&&(s.innerHTML=i),(!c||m&4&&u!==(u=e[13].name))&&_(n,"data-name",u),(!c||m&5)&&w(n,"b3-list-item--focus",e[13].key===e[0])},i(y){c||(S(o.$$.fragment,y),c=!0)},o(y){v(o.$$.fragment,y),c=!1},d(y){y&&O(n),B(o),l=!1,M(p)}}}function Cs(t){let e;return{c(){e=Oe("Container")},m(n,o){A(n,e,o)},d(n){n&&O(e)}}}function Ps(t){let e,n,o,r=[],s=new Map,i,a,u,c=t[3]&&Qt(t),l=$e(t[2]);const p=m=>m[13].key;for(let m=0;m<l.length;m+=1){let g=Jt(t,l,m),E=p(g);s.set(E,r[m]=Yt(E,g))}const b=t[8].default,h=ae(b,t,t[7],Gt),y=h||Cs();return{c(){e=C("div"),n=C("ul"),c&&c.c(),o=F();for(let m=0;m<r.length;m+=1)r[m].c();i=F(),a=C("div"),y&&y.c(),_(n,"class","b3-tab-bar b3-list b3-list--background"),_(a,"class","config__tab-wrap"),_(e,"class","fn__flex-1 fn__flex config__panel")},m(m,g){A(m,e,g),j(e,n),c&&c.m(n,null),j(n,o);for(let E=0;E<r.length;E+=1)r[E]&&r[E].m(n,null);j(e,i),j(e,a),y&&y.m(a,null),u=!0},p(m,[g]){m[3]?c?(c.p(m,g),g&8&&S(c,1)):(c=Qt(m),c.c(),S(c,1),c.m(n,o)):c&&(Ue(),v(c,1,1,()=>{c=null}),Ie()),g&69&&(l=$e(m[2]),Ue(),r=Wn(r,g,p,1,m,l,s,n,Ss,Yt,null,Jt),Ie()),h&&h.p&&(!u||g&129)&&ce(h,b,m,m[7],u?le(b,m[7],g,Ns):ue(m[7]),Gt)},i(m){if(!u){S(c);for(let g=0;g<l.length;g+=1)S(r[g]);S(y,m),u=!0}},o(m){v(c);for(let g=0;g<r.length;g+=1)v(r[g]);v(y,m),u=!1},d(m){m&&O(e),c&&c.d();for(let g=0;g<r.length;g+=1)r[g].d();y&&y.d(m)}}}function Bs(t,e,n){let{$$slots:o={},$$scope:r}=e,{panels:s}=e,{focus:i}=e,{searchEnable:a=!1}=e,{searchPlaceholder:u=""}=e,{searchValue:c=""}=e;const l=zn();function p(){l("search-changed",{value:c})}function b(g){l("changed",{key:g}),n(0,i=g)}function h(){c=this.value,n(1,c)}const y=g=>b(g.key),m=g=>b(g.key);return t.$$set=g=>{"panels"in g&&n(2,s=g.panels),"focus"in g&&n(0,i=g.focus),"searchEnable"in g&&n(3,a=g.searchEnable),"searchPlaceholder"in g&&n(4,u=g.searchPlaceholder),"searchValue"in g&&n(1,c=g.searchValue),"$$scope"in g&&n(7,r=g.$$scope)},[i,c,s,a,u,p,b,r,o,h,y,m]}class Rs extends me{constructor(e){super(),de(this,e,Bs,Ps,pe,{panels:2,focus:0,searchEnable:3,searchPlaceholder:4,searchValue:1})}}function Ls(t){let e,n;const o=t[4].default,r=ae(o,t,t[3],null);return{c(){e=C("div"),r&&r.c(),_(e,"data-name",t[2]),_(e,"class","config__tab-container"),w(e,"fn__none",!t[0]),w(e,"config__tab-container--top",t[1])},m(s,i){A(s,e,i),r&&r.m(e,null),n=!0},p(s,[i]){r&&r.p&&(!n||i&8)&&ce(r,o,s,s[3],n?le(o,s[3],i,null):ue(s[3]),null),(!n||i&4)&&_(e,"data-name",s[2]),(!n||i&1)&&w(e,"fn__none",!s[0]),(!n||i&2)&&w(e,"config__tab-container--top",s[1])},i(s){n||(S(r,s),n=!0)},o(s){v(r,s),n=!1},d(s){s&&O(e),r&&r.d(s)}}}function Ds(t,e,n){let{$$slots:o={},$$scope:r}=e,{display:s=!0}=e,{top:i=!0}=e,{name:a=""}=e;return t.$$set=u=>{"display"in u&&n(0,s=u.display),"top"in u&&n(1,i=u.top),"name"in u&&n(2,a=u.name),"$$scope"in u&&n(3,r=u.$$scope)},[s,i,a,r,o]}class et extends me{constructor(e){super(),de(this,e,Ds,Ls,pe,{display:0,top:1,name:2})}}const js=t=>({}),Xt=t=>({}),Fs=t=>({}),Zt=t=>({}),qs=t=>({}),en=t=>({}),Ms=t=>({}),tn=t=>({});function Us(t){let e,n;return{c(){e=new Hn(!1),n=Et(),e.a=n},m(o,r){e.m(t[0],o,r),A(o,n,r)},p(o,r){r&1&&e.p(o[0])},d(o){o&&(O(n),e.d())}}}function Is(t){let e,n;return{c(){e=new Hn(!1),n=Et(),e.a=n},m(o,r){e.m(t[1],o,r),A(o,n,r)},p(o,r){r&2&&e.p(o[1])},d(o){o&&(O(n),e.d())}}}function nn(t){let e,n,o;const r=t[4].input,s=ae(r,t,t[3],Zt);return{c(){e=C("div"),n=F(),s&&s.c(),_(e,"class","fn__hr")},m(i,a){A(i,e,a),A(i,n,a),s&&s.m(i,a),o=!0},p(i,a){s&&s.p&&(!o||a&8)&&ce(s,r,i,i[3],o?le(r,i[3],a,Fs):ue(i[3]),Zt)},i(i){o||(S(s,i),o=!0)},o(i){v(s,i),o=!1},d(i){i&&(O(e),O(n)),s&&s.d(i)}}}function on(t){let e,n,o;const r=t[4].input,s=ae(r,t,t[3],Xt);return{c(){e=C("span"),n=F(),s&&s.c(),_(e,"class","fn__space")},m(i,a){A(i,e,a),A(i,n,a),s&&s.m(i,a),o=!0},p(i,a){s&&s.p&&(!o||a&8)&&ce(s,r,i,i[3],o?le(r,i[3],a,js):ue(i[3]),Xt)},i(i){o||(S(s,i),o=!0)},o(i){v(s,i),o=!1},d(i){i&&(O(e),O(n)),s&&s.d(i)}}}function $s(t){let e,n,o,r,s,i,a;const u=t[4].title,c=ae(u,t,t[3],tn),l=c||Us(t),p=t[4].text,b=ae(p,t,t[3],en),h=b||Is(t);let y=t[2]&&nn(t),m=!t[2]&&on(t);return{c(){e=C("label"),n=C("div"),l&&l.c(),o=F(),r=C("div"),h&&h.c(),s=F(),y&&y.c(),i=F(),m&&m.c(),_(r,"class","b3-label__text"),_(n,"class","fn__flex-1 svelte-2m76cy"),w(n,"visible",t[2]),_(e,"class","fn__flex b3-label")},m(g,E){A(g,e,E),j(e,n),l&&l.m(n,null),j(n,o),j(n,r),h&&h.m(r,null),j(n,s),y&&y.m(n,null),j(e,i),m&&m.m(e,null),a=!0},p(g,[E]){c?c.p&&(!a||E&8)&&ce(c,u,g,g[3],a?le(u,g[3],E,Ms):ue(g[3]),tn):l&&l.p&&(!a||E&1)&&l.p(g,a?E:-1),b?b.p&&(!a||E&8)&&ce(b,p,g,g[3],a?le(p,g[3],E,qs):ue(g[3]),en):h&&h.p&&(!a||E&2)&&h.p(g,a?E:-1),g[2]?y?(y.p(g,E),E&4&&S(y,1)):(y=nn(g),y.c(),S(y,1),y.m(n,null)):y&&(Ue(),v(y,1,1,()=>{y=null}),Ie()),(!a||E&4)&&w(n,"visible",g[2]),g[2]?m&&(Ue(),v(m,1,1,()=>{m=null}),Ie()):m?(m.p(g,E),E&4&&S(m,1)):(m=on(g),m.c(),S(m,1),m.m(e,null))},i(g){a||(S(l,g),S(h,g),S(y),S(m),a=!0)},o(g){v(l,g),v(h,g),v(y),v(m),a=!1},d(g){g&&O(e),l&&l.d(g),h&&h.d(g),y&&y.d(),m&&m.d()}}}function Hs(t,e,n){let{$$slots:o={},$$scope:r}=e,{title:s=""}=e,{text:i=""}=e,{block:a=!1}=e;return t.$$set=u=>{"title"in u&&n(0,s=u.title),"text"in u&&n(1,i=u.text),"block"in u&&n(2,a=u.block),"$$scope"in u&&n(3,r=u.$$scope)},[s,i,a,r,o]}class X extends me{constructor(e){super(),de(this,e,Hs,$s,pe,{title:0,text:1,block:2})}}var q=(t=>(t[t.checkbox=0]="checkbox",t[t.text=1]="text",t[t.number=2]="number",t[t.slider=3]="slider",t[t.button=4]="button",t[t.select=5]="select",t[t.textarea=6]="textarea",t))(q||{});function rn(t,e,n){const o=t.slice();return o[20]=e[n],o}function zs(t){let e,n,o;return{c(){e=C("textarea"),e.disabled=t[2],_(e,"class","b3-text-field"),_(e,"placeholder",t[5]),w(e,"fn__block",t[3]),w(e,"fn__size200",!t[3]&&t[4]),Re(e,"height",t[8]>0?`${t[8]}px`:void 0),Re(e,"font-family",t[9]?t[9]:void 0)},m(r,s){A(r,e,s),I(e,t[0]),n||(o=[D(e,"input",t[18]),D(e,"change",t[11])],n=!0)},p(r,s){s&4&&(e.disabled=r[2]),s&32&&_(e,"placeholder",r[5]),s&65&&I(e,r[0]),s&8&&w(e,"fn__block",r[3]),s&24&&w(e,"fn__size200",!r[3]&&r[4]),s&256&&Re(e,"height",r[8]>0?`${r[8]}px`:void 0),s&512&&Re(e,"font-family",r[9]?r[9]:void 0)},d(r){r&&O(e),n=!1,M(o)}}}function Vs(t){let e,n=[],o=new Map,r,s,i=$e(t[6]);const a=u=>u[20].key;for(let u=0;u<i.length;u+=1){let c=rn(t,i,u),l=a(c);o.set(l,n[u]=sn(l,c))}return{c(){e=C("select");for(let u=0;u<n.length;u+=1)n[u].c();e.disabled=t[2],_(e,"class","b3-select"),t[0]===void 0&&Me(()=>t[17].call(e)),w(e,"fn__block",t[3]),w(e,"fn__size200",!t[3]&&t[4]),w(e,"fn__flex-center",!t[3])},m(u,c){A(u,e,c);for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(e,null);Wt(e,t[0],!0),r||(s=[D(e,"change",t[17]),D(e,"change",t[11])],r=!0)},p(u,c){c&64&&(i=$e(u[6]),n=Wn(n,c,a,1,u,i,o,e,Es,sn,null,rn)),c&4&&(e.disabled=u[2]),c&65&&Wt(e,u[0]),c&8&&w(e,"fn__block",u[3]),c&24&&w(e,"fn__size200",!u[3]&&u[4]),c&8&&w(e,"fn__flex-center",!u[3])},d(u){u&&O(e);for(let c=0;c<n.length;c+=1)n[c].d();r=!1,M(s)}}}function Ws(t){let e,n,o,r;return{c(){e=C("button"),n=Oe(t[0]),e.disabled=t[2],_(e,"class","b3-button b3-button--outline"),w(e,"fn__block",t[3]),w(e,"fn__size200",!t[3]&&t[4]),w(e,"fn__flex-center",!t[3])},m(s,i){A(s,e,i),j(e,n),o||(r=D(e,"click",t[10]),o=!0)},p(s,i){i&1&&$n(n,s[0]),i&4&&(e.disabled=s[2]),i&8&&w(e,"fn__block",s[3]),i&24&&w(e,"fn__size200",!s[3]&&s[4]),i&8&&w(e,"fn__flex-center",!s[3])},d(s){s&&O(e),o=!1,r()}}}function xs(t){let e,n,o,r,s,i;return{c(){e=C("input"),e.disabled=t[2],_(e,"class","b3-slider svelte-edt8og"),_(e,"type","range"),_(e,"min",n=t[7].min),_(e,"max",o=t[7].max),_(e,"step",r=t[7].step),w(e,"fn__block",t[3]),w(e,"fn__size200",!t[3]&&t[4])},m(a,u){A(a,e,u),I(e,t[0]),s||(i=[D(e,"change",t[16]),D(e,"input",t[16]),D(e,"change",t[11])],s=!0)},p(a,u){u&4&&(e.disabled=a[2]),u&128&&n!==(n=a[7].min)&&_(e,"min",n),u&128&&o!==(o=a[7].max)&&_(e,"max",o),u&128&&r!==(r=a[7].step)&&_(e,"step",r),u&65&&I(e,a[0]),u&8&&w(e,"fn__block",a[3]),u&24&&w(e,"fn__size200",!a[3]&&a[4])},d(a){a&&O(e),s=!1,M(i)}}}function Ks(t){let e,n,o,r,s,i;return{c(){e=C("input"),e.disabled=t[2],_(e,"class","b3-text-field"),_(e,"type","number"),_(e,"placeholder",t[5]),_(e,"min",n=t[7].min),_(e,"max",o=t[7].max),_(e,"step",r=t[7].step),w(e,"fn__block",t[3]),w(e,"fn__size200",!t[3]&&t[4]),w(e,"fn__flex-center",!t[3])},m(a,u){A(a,e,u),I(e,t[0]),s||(i=[D(e,"input",t[15]),D(e,"change",t[11])],s=!0)},p(a,u){u&4&&(e.disabled=a[2]),u&32&&_(e,"placeholder",a[5]),u&128&&n!==(n=a[7].min)&&_(e,"min",n),u&128&&o!==(o=a[7].max)&&_(e,"max",o),u&128&&r!==(r=a[7].step)&&_(e,"step",r),u&65&&ft(e.value)!==a[0]&&I(e,a[0]),u&8&&w(e,"fn__block",a[3]),u&24&&w(e,"fn__size200",!a[3]&&a[4]),u&8&&w(e,"fn__flex-center",!a[3])},d(a){a&&O(e),s=!1,M(i)}}}function Gs(t){let e,n,o;return{c(){e=C("input"),e.disabled=t[2],_(e,"class","b3-text-field"),_(e,"placeholder",t[5]),w(e,"fn__block",t[3]),w(e,"fn__size200",!t[3]&&t[4]),w(e,"fn__flex-center",!t[3])},m(r,s){A(r,e,s),I(e,t[0]),n||(o=[D(e,"input",t[14]),D(e,"change",t[11])],n=!0)},p(r,s){s&4&&(e.disabled=r[2]),s&32&&_(e,"placeholder",r[5]),s&65&&e.value!==r[0]&&I(e,r[0]),s&8&&w(e,"fn__block",r[3]),s&24&&w(e,"fn__size200",!r[3]&&r[4]),s&8&&w(e,"fn__flex-center",!r[3])},d(r){r&&O(e),n=!1,M(o)}}}function Js(t){let e,n,o;return{c(){e=C("input"),e.disabled=t[2],_(e,"class","b3-switch svelte-edt8og"),_(e,"type","checkbox"),w(e,"fn__block",t[3]),w(e,"fn__flex-center",!t[3])},m(r,s){A(r,e,s),e.checked=t[0],n||(o=[D(e,"change",t[13]),D(e,"change",t[11])],n=!0)},p(r,s){s&4&&(e.disabled=r[2]),s&65&&(e.checked=r[0]),s&8&&w(e,"fn__block",r[3]),s&8&&w(e,"fn__flex-center",!r[3])},d(r){r&&O(e),n=!1,M(o)}}}function sn(t,e){let n,o=e[20].text+"",r,s;return{key:t,first:null,c(){n=C("option"),r=Oe(o),n.__value=s=e[20].key,I(n,n.__value),this.first=n},m(i,a){A(i,n,a),j(n,r)},p(i,a){e=i,a&64&&o!==(o=e[20].text+"")&&$n(r,o),a&64&&s!==(s=e[20].key)&&(n.__value=s,I(n,n.__value))},d(i){i&&O(n)}}}function Qs(t){let e;function n(s,i){if(s[1]===q.checkbox)return Js;if(s[1]===q.text)return Gs;if(s[1]===q.number)return Ks;if(s[1]===q.slider)return xs;if(s[1]===q.button)return Ws;if(s[1]===q.select)return Vs;if(s[1]===q.textarea)return zs}let o=n(t),r=o&&o(t);return{c(){r&&r.c(),e=Et()},m(s,i){r&&r.m(s,i),A(s,e,i)},p(s,[i]){o===(o=n(s))&&r?r.p(s,i):(r&&r.d(1),r=o&&o(s),r&&(r.c(),r.m(e.parentNode,e)))},i:Y,o:Y,d(s){s&&O(e),r&&r.d(s)}}}function Ys(t,e,n){let{type:o}=e,{settingKey:r}=e,{settingValue:s}=e,{disabled:i=!1}=e,{block:a=!1}=e,{normal:u=!0}=e,{placeholder:c=""}=e,{options:l=[]}=e,{limits:p={min:0,max:100,step:1}}=e,{height:b=0}=e,{fontFamily:h=""}=e;const y=zn();function m(k){y("clicked",{event:k})}function g(k){y("changed",{key:r,value:s,event:k})}function E(){s=this.checked,n(0,s),n(6,l)}function K(){s=this.value,n(0,s),n(6,l)}function Ae(){s=ft(this.value),n(0,s),n(6,l)}function Ne(){s=ft(this.value),n(0,s),n(6,l)}function Ce(){s=ms(this),n(0,s),n(6,l)}function ge(){s=this.value,n(0,s),n(6,l)}return t.$$set=k=>{"type"in k&&n(1,o=k.type),"settingKey"in k&&n(12,r=k.settingKey),"settingValue"in k&&n(0,s=k.settingValue),"disabled"in k&&n(2,i=k.disabled),"block"in k&&n(3,a=k.block),"normal"in k&&n(4,u=k.normal),"placeholder"in k&&n(5,c=k.placeholder),"options"in k&&n(6,l=k.options),"limits"in k&&n(7,p=k.limits),"height"in k&&n(8,b=k.height),"fontFamily"in k&&n(9,h=k.fontFamily)},[s,o,i,a,u,c,l,p,b,h,m,g,r,E,K,Ae,Ne,Ce,ge]}class ee extends me{constructor(e){super(),de(this,e,Ys,Qs,pe,{type:1,settingKey:12,settingValue:0,disabled:2,block:3,normal:4,placeholder:5,options:6,limits:7,height:8,fontFamily:9})}}function Xs(t){let e,n;return e=new ee({props:{slot:"input",type:q.button,settingKey:"Reset",settingValue:t[1].settings.generalSettings.reset.text}}),e.$on("clicked",t[3]),{c(){R(e.$$.fragment)},m(o,r){P(e,o,r),n=!0},p:Y,i(o){n||(S(e.$$.fragment,o),n=!0)},o(o){v(e.$$.fragment,o),n=!1},d(o){B(e,o)}}}function Zs(t){let e,n;return e=new X({props:{title:t[1].settings.generalSettings.reset.title,text:t[1].settings.generalSettings.reset.description,$$slots:{input:[Xs]},$$scope:{ctx:t}}}),{c(){R(e.$$.fragment)},m(o,r){P(e,o,r),n=!0},p(o,r){const s={};r&16384&&(s.$$scope={dirty:r,ctx:o}),e.$set(s)},i(o){n||(S(e.$$.fragment,o),n=!0)},o(o){v(e.$$.fragment,o),n=!1},d(o){B(e,o)}}}function ei(t){let e,n;return e=new ee({props:{slot:"input",type:q.checkbox,settingKey:"enable",settingValue:t[0].focus.enable}}),e.$on("changed",t[6]),{c(){R(e.$$.fragment)},m(o,r){P(e,o,r),n=!0},p(o,r){const s={};r&1&&(s.settingValue=o[0].focus.enable),e.$set(s)},i(o){n||(S(e.$$.fragment,o),n=!0)},o(o){v(e.$$.fragment,o),n=!1},d(o){B(e,o)}}}function ti(t){let e,n;return e=new X({props:{title:t[1].settings.focusSettings.enable.title,text:t[1].settings.focusSettings.enable.description,$$slots:{input:[ei]},$$scope:{ctx:t}}}),{c(){R(e.$$.fragment)},m(o,r){P(e,o,r),n=!0},p(o,r){const s={};r&16385&&(s.$$scope={dirty:r,ctx:o}),e.$set(s)},i(o){n||(S(e.$$.fragment,o),n=!0)},o(o){v(e.$$.fragment,o),n=!1},d(o){B(e,o)}}}function ni(t){let e,n;return e=new ee({props:{slot:"input",type:q.checkbox,settingKey:"enable",settingValue:t[0].typewriter.enable}}),e.$on("changed",t[7]),{c(){R(e.$$.fragment)},m(o,r){P(e,o,r),n=!0},p(o,r){const s={};r&1&&(s.settingValue=o[0].typewriter.enable),e.$set(s)},i(o){n||(S(e.$$.fragment,o),n=!0)},o(o){v(e.$$.fragment,o),n=!1},d(o){B(e,o)}}}function oi(t){let e,n;return e=new ee({props:{slot:"input",type:q.checkbox,settingKey:"code",settingValue:t[0].typewriter.code.row}}),e.$on("changed",t[8]),{c(){R(e.$$.fragment)},m(o,r){P(e,o,r),n=!0},p(o,r){const s={};r&1&&(s.settingValue=o[0].typewriter.code.row),e.$set(s)},i(o){n||(S(e.$$.fragment,o),n=!0)},o(o){v(e.$$.fragment,o),n=!1},d(o){B(e,o)}}}function ri(t){let e,n;return e=new ee({props:{slot:"input",type:q.checkbox,settingKey:"table",settingValue:t[0].typewriter.table.row}}),e.$on("changed",t[9]),{c(){R(e.$$.fragment)},m(o,r){P(e,o,r),n=!0},p(o,r){const s={};r&1&&(s.settingValue=o[0].typewriter.table.row),e.$set(s)},i(o){n||(S(e.$$.fragment,o),n=!0)},o(o){v(e.$$.fragment,o),n=!1},d(o){B(e,o)}}}function si(t){let e,n;return e=new ee({props:{slot:"input",type:q.checkbox,settingKey:"view",settingValue:t[0].typewriter.view.row}}),e.$on("changed",t[10]),{c(){R(e.$$.fragment)},m(o,r){P(e,o,r),n=!0},p(o,r){const s={};r&1&&(s.settingValue=o[0].typewriter.view.row),e.$set(s)},i(o){n||(S(e.$$.fragment,o),n=!0)},o(o){v(e.$$.fragment,o),n=!1},d(o){B(e,o)}}}function ii(t){let e,n;return e=new ee({props:{slot:"input",type:q.number,settingKey:"timeout",settingValue:t[0].typewriter.timeout,limits:{min:0,max:1/0,step:25}}}),e.$on("changed",t[11]),{c(){R(e.$$.fragment)},m(o,r){P(e,o,r),n=!0},p(o,r){const s={};r&1&&(s.settingValue=o[0].typewriter.timeout),e.$set(s)},i(o){n||(S(e.$$.fragment,o),n=!0)},o(o){v(e.$$.fragment,o),n=!1},d(o){B(e,o)}}}function ai(t){let e,n,o,r,s,i,a,u,c,l;return e=new X({props:{title:t[1].settings.typewriterSettings.enable.title,text:t[1].settings.typewriterSettings.enable.description,$$slots:{input:[ni]},$$scope:{ctx:t}}}),o=new X({props:{title:t[1].settings.typewriterSettings.code.title,text:t[1].settings.typewriterSettings.code.description,$$slots:{input:[oi]},$$scope:{ctx:t}}}),s=new X({props:{title:t[1].settings.typewriterSettings.table.title,text:t[1].settings.typewriterSettings.table.description,$$slots:{input:[ri]},$$scope:{ctx:t}}}),a=new X({props:{title:t[1].settings.typewriterSettings.view.title,text:t[1].settings.typewriterSettings.view.description,$$slots:{input:[si]},$$scope:{ctx:t}}}),c=new X({props:{title:t[1].settings.typewriterSettings.timeout.title,text:t[1].settings.typewriterSettings.timeout.description,$$slots:{input:[ii]},$$scope:{ctx:t}}}),{c(){R(e.$$.fragment),n=F(),R(o.$$.fragment),r=F(),R(s.$$.fragment),i=F(),R(a.$$.fragment),u=F(),R(c.$$.fragment)},m(p,b){P(e,p,b),A(p,n,b),P(o,p,b),A(p,r,b),P(s,p,b),A(p,i,b),P(a,p,b),A(p,u,b),P(c,p,b),l=!0},p(p,b){const h={};b&16385&&(h.$$scope={dirty:b,ctx:p}),e.$set(h);const y={};b&16385&&(y.$$scope={dirty:b,ctx:p}),o.$set(y);const m={};b&16385&&(m.$$scope={dirty:b,ctx:p}),s.$set(m);const g={};b&16385&&(g.$$scope={dirty:b,ctx:p}),a.$set(g);const E={};b&16385&&(E.$$scope={dirty:b,ctx:p}),c.$set(E)},i(p){l||(S(e.$$.fragment,p),S(o.$$.fragment,p),S(s.$$.fragment,p),S(a.$$.fragment,p),S(c.$$.fragment,p),l=!0)},o(p){v(e.$$.fragment,p),v(o.$$.fragment,p),v(s.$$.fragment,p),v(a.$$.fragment,p),v(c.$$.fragment,p),l=!1},d(p){p&&(O(n),O(r),O(i),O(u)),B(e,p),B(o,p),B(s,p),B(a,p),B(c,p)}}}function li(t){let e,n,o,r,s,i;return e=new et({props:{display:t[4][0].key===t[13],$$slots:{default:[Zs]},$$scope:{ctx:t}}}),o=new et({props:{display:t[4][1].key===t[13],$$slots:{default:[ti]},$$scope:{ctx:t}}}),s=new et({props:{display:t[4][2].key===t[13],$$slots:{default:[ai]},$$scope:{ctx:t}}}),{c(){R(e.$$.fragment),n=F(),R(o.$$.fragment),r=F(),R(s.$$.fragment)},m(a,u){P(e,a,u),A(a,n,u),P(o,a,u),A(a,r,u),P(s,a,u),i=!0},p(a,u){const c={};u&8192&&(c.display=a[4][0].key===a[13]),u&16384&&(c.$$scope={dirty:u,ctx:a}),e.$set(c);const l={};u&8192&&(l.display=a[4][1].key===a[13]),u&16385&&(l.$$scope={dirty:u,ctx:a}),o.$set(l);const p={};u&8192&&(p.display=a[4][2].key===a[13]),u&16385&&(p.$$scope={dirty:u,ctx:a}),s.$set(p)},i(a){i||(S(e.$$.fragment,a),S(o.$$.fragment,a),S(s.$$.fragment,a),i=!0)},o(a){v(e.$$.fragment,a),v(o.$$.fragment,a),v(s.$$.fragment,a),i=!1},d(a){a&&(O(n),O(r)),B(e,a),B(o,a),B(s,a)}}}function ci(t){let e,n;return e=new Rs({props:{panels:t[4],focus:ui,$$slots:{default:[li,({focus:o})=>({13:o}),({focus:o})=>o?8192:0]},$$scope:{ctx:t}}}),{c(){R(e.$$.fragment)},m(o,r){P(e,o,r),n=!0},p(o,[r]){const s={};r&24577&&(s.$$scope={dirty:r,ctx:o}),e.$set(s)},i(o){n||(S(e.$$.fragment,o),n=!0)},o(o){v(e.$$.fragment,o),n=!1},d(o){B(e,o)}}}let ui=0;function fi(t,e,n){let{config:o}=e,{plugin:r}=e;const s=r.i18n;async function i(){await r.updateConfig(o)}function a(){r.siyuan.confirm(s.settings.generalSettings.reset.title,s.settings.generalSettings.reset.description,async()=>{await r.resetConfig(),globalThis.location.reload()})}const u=[{key:0,text:s.settings.generalSettings.title,name:s.settings.generalSettings.title,icon:"#iconSettings"},{key:1,text:s.settings.focusSettings.title,name:s.settings.focusSettings.title,icon:"#iconFocus"},{key:2,text:s.settings.typewriterSettings.title,name:s.settings.typewriterSettings.title,icon:"#iconKeymap"}],c=async m=>{n(0,o.focus.enable=m.detail.value,o),await i()},l=async m=>{n(0,o.typewriter.enable=m.detail.value,o),await i()},p=async m=>{n(0,o.typewriter.code.row=m.detail.value,o),await i()},b=async m=>{n(0,o.typewriter.table.row=m.detail.value,o),await i()},h=async m=>{n(0,o.typewriter.view.row=m.detail.value,o),await i()},y=async m=>{n(0,o.typewriter.timeout=m.detail.value,o),await i()};return t.$$set=m=>{"config"in m&&n(0,o=m.config),"plugin"in m&&n(5,r=m.plugin)},[o,s,i,a,u,r,c,l,p,b,h,y]}class hi extends me{constructor(e){super(),de(this,e,fi,ci,pe,{config:0,plugin:5})}}pi();mi();const an=di();function pi(){switch(re.getFrontend()){case"desktop":case"desktop-window":case"browser-desktop":return!0;case"mobile":case"browser-mobile":return!1;default:return!1}}function di(){switch(re.getFrontend()){case"mobile":case"browser-mobile":return!0;case"desktop":case"desktop-window":case"browser-desktop":return!1;default:return!1}}function mi(){switch(re.getFrontend()){case"browser-desktop":case"browser-mobile":return!0;case"desktop":case"desktop-window":case"mobile":return!1;default:return!1}}class gi{constructor(e,n=!0){this.label=e,this.collapsed=n}stdout(e,n,...o){const r=`[\x1B[4m${this.label}\x1B[0m] - <\x1B[1m${e.name.toUpperCase()}\x1B[0m>`;if(this.collapsed?globalThis.console.groupCollapsed(r):globalThis.console.group(r),n)for(const s of o)Array.isArray(s)?e(...s):e(s);else e(...o);globalThis.console.trace(),globalThis.console.groupEnd()}dir(...e){this.stdout(globalThis.console.dir,!1,...e)}dirs(...e){this.stdout(globalThis.console.dir,!0,...e)}table(...e){this.stdout(globalThis.console.table,!1,...e)}tables(...e){this.stdout(globalThis.console.table,!0,...e)}debug(...e){this.stdout(globalThis.console.debug,!1,...e)}debugs(...e){this.stdout(globalThis.console.debug,!0,...e)}info(...e){this.stdout(globalThis.console.info,!1,...e)}infos(...e){this.stdout(globalThis.console.info,!0,...e)}log(...e){this.stdout(globalThis.console.log,!1,...e)}logs(...e){this.stdout(globalThis.console.log,!0,...e)}warn(...e){this.stdout(globalThis.console.warn,!1,...e)}warns(...e){this.stdout(globalThis.console.warn,!0,...e)}error(...e){this.stdout(globalThis.console.error,!1,...e)}errors(...e){this.stdout(globalThis.console.error,!0,...e)}}function bi(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var yi=function(e){return _i(e)&&!wi(e)};function _i(t){return!!t&&typeof t=="object"}function wi(t){var e=Object.prototype.toString.call(t);return e==="[object RegExp]"||e==="[object Date]"||Si(t)}var ki=typeof Symbol=="function"&&Symbol.for,Ei=ki?Symbol.for("react.element"):60103;function Si(t){return t.$$typeof===Ei}function Ti(t){return Array.isArray(t)?[]:{}}function Se(t,e){return e.clone!==!1&&e.isMergeableObject(t)?fe(Ti(t),t,e):t}function vi(t,e,n){return t.concat(e).map(function(o){return Se(o,n)})}function Oi(t,e){if(!e.customMerge)return fe;var n=e.customMerge(t);return typeof n=="function"?n:fe}function Ai(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter(function(e){return Object.propertyIsEnumerable.call(t,e)}):[]}function ln(t){return Object.keys(t).concat(Ai(t))}function Kn(t,e){try{return e in t}catch{return!1}}function Ni(t,e){return Kn(t,e)&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))}function Ci(t,e,n){var o={};return n.isMergeableObject(t)&&ln(t).forEach(function(r){o[r]=Se(t[r],n)}),ln(e).forEach(function(r){Ni(t,r)||(Kn(t,r)&&n.isMergeableObject(e[r])?o[r]=Oi(r,n)(t[r],e[r],n):o[r]=Se(e[r],n))}),o}function fe(t,e,n){n=n||{},n.arrayMerge=n.arrayMerge||vi,n.isMergeableObject=n.isMergeableObject||yi,n.cloneUnlessOtherwiseSpecified=Se;var o=Array.isArray(e),r=Array.isArray(t),s=o===r;return s?o?n.arrayMerge(t,e,n):Ci(t,e,n):Se(e,n)}fe.all=function(e,n){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce(function(o,r){return fe(o,r,n)},{})};var Pi=fe,Bi=Pi;const Ri=bi(Bi);function cn(...t){return Ri.all(t,{arrayMerge:(e,n,o)=>n})}function Li(t=globalThis.siyuan){var n,o,r;const e=[];if((n=t==null?void 0:t.mobile)!=null&&n.editor&&e.push(t.mobile.editor),(o=t==null?void 0:t.layout)!=null&&o.centerLayout){const s=[];for(s.push(t.layout.centerLayout);s.length>0;){const i=s.pop();if(i.children.length>0)for(let a of i.children)(r=a.model)!=null&&r.editor?e.push(a.model.editor):a.children&&s.push(a)}}return e}function Di(t=globalThis.siyuan){const e=[];for(const n of t.blockPanels)for(const o of n.editors)e.push(o);return e}function ji(t=globalThis.siyuan){return[...Li(t),...Di(t)]}function un(t,e=100){let n;return function(...o){clearTimeout(n),n=setTimeout(()=>{t.apply(this,o)},e)}}function Fi(t){return!!(t&&t instanceof HTMLElement&&t.dataset.type&&t.dataset.nodeId&&pt.id.test(t.dataset.nodeId))}function qi(t){return!!(t&&t instanceof HTMLElement&&t.classList.contains("protyle-wysiwyg"))}const Mi=qi;function Ui(t){return!!(t&&t instanceof HTMLElement&&t.classList.contains("protyle-content"))}function fn(){const t=document.getSelection();for(var e=t==null?void 0:t.focusNode;e&&(!(e instanceof HTMLElement)||!Fi(e));)e=e.parentElement;return e}function Gn(){for(var t=globalThis.document.activeElement;t&&(!(t instanceof HTMLElement)||!Mi(t));)t=t.parentElement;return t}function Ii(){const t=Gn();return Ui(t==null?void 0:t.parentElement)?t==null?void 0:t.parentElement:void 0}function $i(t=(e=>(e=globalThis.document.getSelection())==null?void 0:e.focusNode)()){for(;t&&(!(t instanceof HTMLElement)||!t.classList.contains("hljs"));)t=t.parentElement;return t}function Hi(){const t=globalThis.document.getSelection();if((t==null?void 0:t.rangeCount)===1){const e=t.getRangeAt(0),n=$i(e.commonAncestorContainer);if(n){const o=n.textContent??"",r=globalThis.document.createRange(),s=globalThis.document.createRange(),i=globalThis.document.createRange(),a=globalThis.document.createRange(),{anchorNode:u,anchorOffset:c,focusNode:l,focusOffset:p}=t;if(u&&l&&n.firstChild&&n.lastChild){const b=u===l?c<=p:!!(u.compareDocumentPosition(l)&Node.DOCUMENT_POSITION_FOLLOWING);r.setStartBefore(n.firstChild),s.setEndAfter(n.lastChild),i.setStartBefore(n.firstChild),a.setEndAfter(n.lastChild),b?(r.setEnd(u,c),s.setStart(l,p)):(r.setEnd(l,p),s.setStart(u,c)),i.setEnd(l,p),a.setStart(l,p);const h=i.toString(),y=h.split(`
`),m=y.at(-1),g=y.length,E=m.length,K=h.length;return{code:o,row:g,column:E,offset:K,container:n,selection:t,order:b,before:r,current:e,after:s,prefix:i,suffix:a}}}}}const tt={typewriter:{enable:!0,timeout:250,code:{row:!0},table:{row:!0},view:{row:!0}},focus:{enable:!0}},V={FOCUS_ELEMENT_UNIQUE_ID:"plugin-focus-unique-id",FOCUS_ELEMENT_ATTR_NAME:"data-plugin-focus",FOCUS_ELEMENT_DATA_NAME:"pluginFocus"},we=class we extends re.Plugin{constructor(n){super(n);N(this,"siyuan",re);N(this,"logger");N(this,"client");N(this,"SETTINGS_DIALOG_ID");N(this,"protyles",new WeakSet);N(this,"focus",new WeakMap);N(this,"config",tt);N(this,"scrollIntoView");N(this,"scrollBy");N(this,"currentElement");N(this,"topBarButton");N(this,"toggleEnableState",()=>{this.config.typewriter.enable=!this.config.typewriter.enable,this.activate()});N(this,"loadedProtyleStaticEventListener",n=>{if(this.enable){const o=n.detail.protyle;this.toggleEventListener(o,!0)}});N(this,"destroyProtyleEventListener",n=>{const o=n.detail.protyle;this.toggleEventListener(o,!1)});N(this,"clickEditorContentEventListener",n=>{if(this.enable){const o=n.detail.event;this.editorEventListener(o)}});N(this,"editorEventListener",async n=>{var o,r,s,i;if(this.config.focus.enable){const a=fn(),u=Gn();if(a&&u){let c;switch(a.dataset.type){case"NodeTable":{let b=(o=globalThis.getSelection())==null?void 0:o.focusNode;for(;b;){if(b instanceof HTMLElement&&(b.localName==="td"||b.localName==="th"))break;b=b.parentElement}c=b??a;break}case"NodeAttributeView":{c=a.querySelector(".av__cell--select")??a;break}default:c=a;break}const l=globalThis.document.getElementById(V.FOCUS_ELEMENT_UNIQUE_ID);c!==l&&(l==null||l.removeAttribute("id"),c.id=V.FOCUS_ELEMENT_UNIQUE_ID);const p=this.focus.get(u);c!==p&&(p==null||delete p.dataset[V.FOCUS_ELEMENT_DATA_NAME],c.dataset[V.FOCUS_ELEMENT_DATA_NAME]=String(!0),this.focus.set(u,c))}else(r=globalThis.document.getElementById(V.FOCUS_ELEMENT_UNIQUE_ID))==null||r.removeAttribute("id"),(s=this.focus.get(u))==null||delete s.dataset[V.FOCUS_ELEMENT_DATA_NAME]}if(this.config.typewriter.enable){const a=fn();if(a){let u=a;switch(a.dataset.type){case"NodeCodeBlock":if(a.classList.contains("render-node"))break;if(this.config.typewriter.code.row){const c=Ii();if(c){const l=globalThis.getSelection(),p=l==null?void 0:l.focusNode,b=Hi();if(p&&b){const{height:h,bottom:y}=c.getBoundingClientRect(),m=parseFloat(globalThis.getComputedStyle(b.container).getPropertyValue("line-height")),g=b.container.getBoundingClientRect().top+m*b.row;this.scrollBy(c,{top:-(y-h/2-(g-m/2)),left:0,behavior:"smooth"})}}return}break;case"NodeTable":if(this.config.typewriter.view.row){let c=(i=globalThis.getSelection())==null?void 0:i.focusNode;for(;c;){if(c instanceof HTMLElement&&(c.localName==="td"||c.localName==="th"))break;c=c.parentElement}u=c??a}break;case"NodeAttributeView":this.config.typewriter.table.row&&(u=a.querySelector(".av__cell--select")??a);break}if(this.currentElement===u)return;this.currentElement=u,this.scrollIntoView(u)}}});this.logger=new gi(this.name),this.client=new fs(void 0,"fetch"),this.SETTINGS_DIALOG_ID=`${this.name}-settings-dialog`,this.updateScrollFunction()}onload(){this.addCommand({langKey:"toggle-typewriter",langText:this.i18n.menu.switch.command.text,hotkey:"T",customHotkey:"T",callback:this.toggleEnableState}),this.loadData(we.GLOBAL_CONFIG_NAME).then(n=>{this.config=cn(tt,n||{}),this.updateScrollFunction()}).catch(n=>this.logger.error(n)).finally(()=>{this.activate()})}onLayoutReady(){this.topBarButton=this.addTopBar({icon:"iconKeymap",title:this.i18n.menu.switch.title,position:"right",callback:this.toggleEnableState}),this.updateTopBarButtonState()}onunload(){this.activate(!1)}openSetting(){const n=this,r=new re.Dialog({title:`${this.displayName} <code class="fn__code">${this.name}</code>`,content:`<div id="${n.SETTINGS_DIALOG_ID}" class="fn__flex-column" />`,width:an?"92vw":"720px",height:an?void 0:"640px"}).element.querySelector(`#${n.SETTINGS_DIALOG_ID}`);r&&new hi({target:r,props:{config:this.config,plugin:this}})}async resetConfig(){return this.updateConfig(cn(tt))}async updateConfig(n){return n&&n!==this.config&&(this.config=n),this.activate(),this.updateScrollFunction(),this.saveData(we.GLOBAL_CONFIG_NAME,this.config)}get enable(){return this.config.typewriter.enable||this.config.focus.enable}toggleEventListener(n,o){var s,i,a,u;const r=["keyup",this.editorEventListener,{capture:!0}];switch(!0){case(o&&!this.protyles.has(n)):this.protyles.add(n),(i=(s=n.wysiwyg)==null?void 0:s.element)==null||i.addEventListener(...r);break;case(!o&&this.protyles.has(n)):this.protyles.delete(n),(u=(a=n.wysiwyg)==null?void 0:a.element)==null||u.removeEventListener(...r);break}}activate(n=this.enable){var r;const o=ji();for(const s of o){const i=s==null?void 0:s.protyle;i&&this.toggleEventListener(i,n)}this.updateTopBarButtonState(),this.config.focus.enable||((r=globalThis.document.getElementById(V.FOCUS_ELEMENT_UNIQUE_ID))==null||r.removeAttribute("id"),globalThis.document.querySelectorAll(`[${V.FOCUS_ELEMENT_ATTR_NAME}]`).forEach(s=>{s instanceof HTMLElement?delete s.dataset[V.FOCUS_ELEMENT_DATA_NAME]:s.removeAttribute(V.FOCUS_ELEMENT_ATTR_NAME)})),n?(this.eventBus.on("loaded-protyle-static",this.loadedProtyleStaticEventListener),this.eventBus.on("destroy-protyle",this.destroyProtyleEventListener),this.eventBus.on("click-editorcontent",this.clickEditorContentEventListener)):(this.eventBus.off("loaded-protyle-static",this.loadedProtyleStaticEventListener),this.eventBus.off("destroy-protyle",this.destroyProtyleEventListener),this.eventBus.off("click-editorcontent",this.clickEditorContentEventListener))}updateTopBarButtonState(){if(this.topBarButton){const n=this.config.typewriter.enable;this.topBarButton.ariaLabel=n?this.i18n.menu.switch.enabled:this.i18n.menu.switch.disabled,this.topBarButton.classList.toggle("toolbar__item--active",n)}}updateScrollFunction(n=this.config.typewriter.timeout){this.scrollIntoView=un(o=>{o.scrollIntoView({behavior:"smooth",inline:"center",block:"center"})},n),this.scrollBy=un((o,r)=>{o.scrollBy(r)},n)}};N(we,"GLOBAL_CONFIG_NAME","global-config");let dt=we;module.exports=dt;
